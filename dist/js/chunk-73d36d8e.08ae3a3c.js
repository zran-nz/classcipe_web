(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73d36d8e"],{"0205":function(e,t,a){"use strict";a("e305")},"09a06":function(e,t,a){"use strict";a("4039f")},"0aff":function(e,t,a){"use strict";a("9469")},1286:function(e,t,a){"use strict";a("2e50")},"178d":function(e,t,a){},"1a1a":function(e,t,a){},"1cde":function(e,t,a){},"21fb":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("b0c0");var n={data:function(){return{unwatch:null,routeName:this.$route.name}},created:function(){var e=this;this.unwatch=this.$store.watch((function(e){return e.user.currentSchool}),(function(t){return t&&e.$route.name===e.routeName&&e.handleSchoolChange(t)}))},computed:{},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{handleSchoolChange:function(e){}}}},"2bdd":function(e,t,a){"use strict";a("1a1a")},"2e50":function(e,t,a){},"2f5d":function(e,t,a){},3009:function(e,t,a){"use strict";a("cfae")},"34da":function(e,t,a){"use strict";a("a66a")},"35ed":function(e,t,a){},"4039f":function(e,t,a){},"4c77":function(e,t,a){"use strict";a("178d")},"4e8a":function(e,t,a){"use strict";a.d(t,"j",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"k",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"m",(function(){return p})),a.d(t,"i",(function(){return h})),a.d(t,"h",(function(){return f})),a.d(t,"l",(function(){return v}));var n=a("b775"),r={getSchoolRoleList:"/classcipe/api/school/role/getRoles",getSchoolClassList:"/classcipe/api/school/class/list",addStaff:"/classcipe/api/school/user/addStaff",addStudent:"/classcipe/api/school/user/addStudents",getOrCreateInvite:"/classcipe/api/school/user/getOrCreateInvite",checkInvite:"/classcipe/api/school/user/checkInvite",acceptInvite:"/classcipe/api/school/user/acceptInvite",updateInvite:"/classcipe/api/school/user/updateInvite",getSchoolUsers:"/classcipe/api/school/user/getSchoolUsers",queryUser:"/classcipe/api/school/user/queryUser",updateUserStatus:"/classcipe/api/school/user/updateUserStatus",importStaff:"/classcipe/api/school/user/importStaffByExcel",importStudent:"/classcipe/api/school/user/importStudentByExcel",exportInvalidStaff:"/classcipe/api/school/user/exportInvalidStaff",exportInvalidStudent:"/classcipe/api/school/user/exportInvalidStudent",removeSchoolUser:"/classcipe/api/school/user/removeSchoolUser",getUserInfo:"/classcipe/api/school/user/getUserInfo",updateProfile:"/classcipe/api/school/user/updateProfile"};function i(e){return Object(n["d"])({url:r.getSchoolRoleList,method:"get",params:e})}function o(e){return Object(n["d"])({url:r.getSchoolClassList,method:"get",params:e})}function s(e){return Object(n["d"])({url:r.addStaff,method:"post",params:e})}function c(e){return Object(n["d"])({url:r.addStudent,method:"post",params:e})}function l(e){return Object(n["d"])({url:r.getOrCreateInvite,method:"post",params:e})}function u(e){return Object(n["d"])({url:r.checkInvite,method:"get",params:e})}function d(e){return Object(n["d"])({url:r.updateInvite,method:"post",params:e})}function m(e){return Object(n["d"])({url:r.getSchoolUsers,method:"get",params:e})}function p(e){return Object(n["d"])({url:r.updateUserStatus,method:"post",params:e})}function h(e){return Object(n["d"])({url:r.removeSchoolUser,method:"post",params:e})}function f(e){return Object(n["d"])({url:r.getUserInfo,method:"get",params:e})}function v(e){return Object(n["d"])({url:r.updateProfile,method:"post",data:e})}},"55ee":function(e,t,a){},"6e84":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("b0c0");var n={data:function(){return{unwatch:null,routeName:this.$route.name}},computed:{redirectUrl:function(){return"student"===this.$store.state.user.currentRole?"/student/main/my-task":"/account/info"}},created:function(){var e=this;this.unwatch=this.$store.watch((function(e){return e.app.userMode}),(function(t){t&&e.$route.name===e.routeName&&(e.handleModeChange(t),e.routeInMode())})),this.routeInMode()},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{routeInMode:function(){this.$route.meta.mode&&this.$route.meta.mode!==this.$store.state.app.userMode&&this.$router.push({path:this.redirectUrl})},handleModeChange:function(e){}}}},7483:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=[{id:0,name:"wait to join"},{id:1,name:"active"},{id:2,name:"approve pending"},{id:3,name:"approve reject"},{id:4,name:"archived"}]},"8d90":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.$t("account.settings.avatar.edit"),visible:e.visible,maskClosable:!1,confirmLoading:e.confirmLoading,width:800,footer:null},on:{cancel:e.cancelHandel}},[a("a-row",[a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,autoCrop:e.options.autoCrop,autoCropWidth:e.options.autoCropWidth,autoCropHeight:e.options.autoCropHeight,fixedBox:e.options.fixedBox},on:{realTime:e.realTime}})],1),a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("div",{staticClass:"avatar-upload-preview"},[a("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),a("br"),a("a-row",[a("a-col",{attrs:{lg:2,md:2}},[a("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{icon:"upload"}},[e._v(e._s(e.$t("account.settings.avatar.select-image")))])],1)],1),a("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[a("a-button",{attrs:{icon:"plus"},on:{click:function(t){return e.changeScale(1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"minus"},on:{click:function(t){return e.changeScale(-1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"undo"},on:{click:e.rotateLeft}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"redo"},on:{click:e.rotateRight}})],1),a("a-col",{attrs:{lg:{span:4,offset:6},md:4}},[a("a-space",[a("a-button",{on:{click:e.close}},[e._v(" Cancel ")]),a("a-button",{attrs:{type:"primary",disabled:e.confirmLoading,loading:e.confirmLoading},on:{click:e.uploadImage}},[e._v("Save")])],1)],1)],1)],1)},r=[],i=(a("ac1f"),a("1276"),a("466d"),a("ace4"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("99af"),a("fb6a"),a("25f0"),a("d0d0")),o={data:function(){return{visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{edit:function(e){this.visible=!0,this.id=e},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(e){var t=this,a=new FileReader;return a.readAsDataURL(e),a.onload=function(){t.options.img=a.result},!1},uploadImage:function(){var e=this;this.$refs.cropper.getCropData((function(t){var a=t.split(","),n=a[0].match(/:(.*?);/)[1],r=atob(a[1]),o=r.length,s=new Uint8Array(o);while(o--)s[o]=r.charCodeAt(o);e.model=!0,e.modelSrc=t;var c=n.split("/")[1],l=new File([s],"custom_image_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2),".").concat(c),{type:n});e.$logger.info("upload file",l),e.confirmLoading=!0,Object(i["a"])(e.$store.getters.userInfo.id,l,e.getProgressUpLoad,(function(t){e.onSuccess(l,t)}),!0)}))},getProgressUpLoad:function(e){this.$logger.info("getProgressUpLoad",e),this.confirmLoading=!0},onSuccess:function(e,t){this.$logger.info("upload success",e,t),this.$emit("ok",t),this.confirmLoading=!1,this.okHandel()},okHandel:function(){var e=this;e.confirmLoading=!0,setTimeout((function(){e.confirmLoading=!1,e.close(),e.$message.success("update avatar successfully!")}),2e3)},realTime:function(e){this.previews=e}}},s=o,c=(a("4c77"),a("0c7c")),l=Object(c["a"])(s,n,r,!1,null,"06163b63",null);t["a"]=l.exports},9130:function(e,t,a){"use strict";a("ec1a")},9469:function(e,t,a){},"9eec":function(e,t,a){},a259:function(e,t,a){"use strict";a("e611")},a66a:function(e,t,a){},ad00:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",e._g(e._b({ref:"modal",class:e.getClass(e.modalClass),style:e.getStyle(e.modalStyle),attrs:{visible:e.visible,destroyOnClose:"",maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel},scopedSlots:e._u([e._l(e.slotsKeys,(function(t){return{key:t,fn:function(){return[e._t(t)]},proxy:!0}}))],null,!0)},"a-modal",e._attrs,!1),e.$listeners),[e._t("default"),e.isNoTitle?a("template",{slot:"title"},[a("a-row",{staticClass:"j-modal-title-row",attrs:{type:"flex"}},[e.switchFullscreen?a("a-col",{staticClass:"right",on:{click:e.toggleFullscreen}},[a("a-button",{staticClass:"ant-modal-close ant-modal-close-x",attrs:{ghost:"",type:"link",icon:e.fullscreenButtonIcon}})],1):e._e()],1)],1):a("template",{slot:"title"},[a("a-row",{staticClass:"j-modal-title-row",attrs:{type:"flex"}},[a("a-col",{staticClass:"left"},[e._t("title",(function(){return[e._v(e._s(e.title))]}))],2),e.switchFullscreen?a("a-col",{staticClass:"right",on:{click:e.toggleFullscreen}},[a("a-button",{staticClass:"ant-modal-close ant-modal-close-x",attrs:{ghost:"",type:"link",icon:e.fullscreenButtonIcon}})],1):e._e()],1)],1),e._l(e.scopedSlotsKeys,(function(t){return a("template",{slot:t},[e._t(t)],2)}))],2)},r=[],i=a("5530"),o=(a("caad"),a("2532"),a("4de4"),a("b64b"),a("99af"),a("53ca"));a("a15b"),a("ac1f"),a("5319"),a("159b"),a("1276"),a("498a");function s(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var n=Object(o["a"])(a);if("string"===n||"number"===n)e.push(a);else if(Array.isArray(a)&&a.length){var r=s.apply(null,a);r&&e.push(r)}else if("object"===n)for(var i in a)a.hasOwnProperty(i)&&a[i]&&e.push(i)}}return e.join(" ")}var c=/-(\w)/g;function l(e){return e.replace(c,(function(e,t){return t?t.toUpperCase():""}))}function u(e){var t={};return Object.keys(e).forEach((function(a){return t[l(a)]=e[a]})),t}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a={},n=/;(?![^(]*\))/g,r=/:(.+)/;return e.split(n).forEach((function(e){if(e){var n=e.split(r);if(n.length>1){var i=t?l(n[0].trim()):n[0].trim();a[i]=n[1].trim()}}})),a}function m(e){var t={};e.data?t=e.data:e.$vnode&&e.$vnode.data&&(t=e.$vnode.data);var a=t.class||{},n=t.staticClass,r={};return n&&n.split(" ").forEach((function(e){r[e.trim()]=!0})),"string"===typeof a?a.split(" ").forEach((function(e){r[e.trim()]=!0})):Array.isArray(a)?s(a).split(" ").forEach((function(e){r[e.trim()]=!0})):r=Object(i["a"])(Object(i["a"])({},r),a),r}function p(e,t){m(e);var a={};e.data?a=e.data:e.$vnode&&e.$vnode.data&&(a=e.$vnode.data);var n=a.style||{},r=a.staticStyle;return r=r?u(a.staticStyle):{},"string"===typeof n?n=d(n,t):t&&n&&(n=u(n)),Object(i["a"])(Object(i["a"])({},r),n)}var h=a("ca00"),f={name:"JModal",props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},switchFullscreen:{type:Boolean,default:!1},okClose:{type:Boolean,default:!0}},data:function(){return{usedSlots:["title"],innerFullscreen:this.fullscreen}},computed:{_attrs:function(){var e=Object(i["a"])({},this.$attrs);return this.innerFullscreen&&(e["width"]="100%"),e},modalClass:function(){return{"j-modal-box":!0,fullscreen:this.innerFullscreen,"no-title":this.isNoTitle,"no-footer":this.isNoFooter}},modalStyle:function(){var e={};return this.innerFullscreen&&(e["top"]="0"),e},isNoTitle:function(){return!this.title&&!this.allSlotsKeys.includes("title")},isNoFooter:function(){return null===this._attrs["footer"]},slotsKeys:function(){var e=this;return Object.keys(this.$slots).filter((function(t){return!e.usedSlots.includes(t)}))},scopedSlotsKeys:function(){var e=this;return Object.keys(this.$scopedSlots).filter((function(t){return!e.usedSlots.includes(t)}))},allSlotsKeys:function(){return Object.keys(this.$slots).concat(Object.keys(this.$scopedSlots))},fullscreenButtonIcon:function(){return this.innerFullscreen?"fullscreen-exit":"fullscreen"}},watch:{visible:function(){this.visible&&(this.innerFullscreen=this.fullscreen)},innerFullscreen:function(e){this.$emit("update:fullscreen",e)}},methods:{getClass:function(e){return Object(i["a"])(Object(i["a"])({},m(this)),e)},getStyle:function(e){return Object(i["a"])(Object(i["a"])({},p(this)),e)},close:function(){this.$emit("update:visible",!1)},handleOk:function(){this.okClose&&this.close()},handleCancel:function(){this.close()},toggleFullscreen:function(){this.innerFullscreen=!this.innerFullscreen,Object(h["triggerWindowResizeEvent"])()}}},v=f,g=(a("0aff"),a("0c7c")),b=Object(g["a"])(v,n,r,!1,null,null,null);t["a"]=b.exports},be59:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"status-tab"},[a("div",{staticClass:"toggle-mode-type-wrapper"},[a("div",{staticClass:"toggle-mode-type"},[a("div",{staticClass:"toggle-mode"},[a("div",{class:{"mode-item":!0,active:"teacher"===e.currentStatus},on:{click:function(t){return e.toggleStatus("teacher")}}},[e._v(" Teachers ")]),a("div",{class:{"mode-item":!0,active:"student"===e.currentStatus},on:{click:function(t){return e.toggleStatus("student")}}},[e._v(" Students ")]),a("div",{class:{"mode-item":!0,active:"admin"===e.currentStatus},on:{click:function(t){return e.toggleStatus("admin")}}},[e._v(" Admin ")]),a("div",{class:{"mode-item":!0,active:"group"===e.currentStatus},on:{click:function(t){return e.toggleStatus("group")}}},[e._v(" Groups ")])])])])]),"teacher"===e.currentStatus?a("SchoolUserTeacher",{ref:"teacherRef"}):e._e(),"student"===e.currentStatus?a("SchoolUserStudent",{ref:"studentRef"}):e._e(),"admin"===e.currentStatus?a("SchoolUserAdmin",{ref:"adminRef"}):e._e(),"group"===e.currentStatus?a("SchoolUserGroup",{ref:"groupRef"}):e._e()],1)},r=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"operator"},[a("div",{staticClass:"status-select"},[a("a",{class:{active:""===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("")}}},[a("span",[e._v("All")])]),a("a",{class:{active:"1"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("1")}}},[a("span",[e._v("Active")])]),a("a",{class:{active:"0,2"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("0,2")}}},[a("span",[e._v("Pending")])]),a("a",{class:{active:"4"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("4")}}},[a("span",[e._v("Archived")])])]),a("div",{staticClass:"upload-wrapper"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("Add")]),a("a-upload",{attrs:{name:"file",showUploadList:!1,multiple:!1,customRequest:e.handleMyImportExcel}},[a("a-button",{attrs:{loading:e.importLoading,type:"primary",icon:"import"}},[e._v(e._s(e.importLoadingText))])],1),a("a-dropdown",[a("a-button",{attrs:{type:"link",shape:"circle",icon:"download"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a-button",{attrs:{type:"link",icon:"download"},on:{click:e.downloadTemplate}},[e._v("Download template")])],1)],1)],1)],1)]),a("div",{staticClass:"search-box"},[a("a-form",{attrs:{form:e.form,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-item",{attrs:{label:""}},[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[]}],expression:"['name', { rules: [] }]"}],staticStyle:{width:"300px"},attrs:{placeholder:"Search for ID、Name、Email...","enter-button":""},on:{search:e.handleSearch}})],1)],1),a("a-col",{attrs:{span:4}},[a("div",{staticStyle:{"line-height":"32px","margin-top":"6px"}},[a("a",{on:{click:e.handleAdvancedSearch}},[a("span",[e._v(e._s(e.showAdvancedSearch?"General Search":"Advanced Search"))])])])])],1),a("a-card",{directives:[{name:"show",rawName:"v-show",value:e.showAdvancedSearch,expression:"showAdvancedSearch"}]},[a("a-row",[a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Groups"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["groups",{rules:[]}],expression:"['groups', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.groupList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Role"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["roles",{rules:[]}],expression:"['roles', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.roleList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Class"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["classes",{rules:[]}],expression:"['classes', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.classList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Grade"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["grades",{rules:[]}],expression:"['grades', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.gradeList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)],1),a("div",{staticClass:"search-box-btn"},[a("a-button",{attrs:{type:"primary",shape:"round"},on:{click:e.handleReset}},[e._v("reset")]),a("a-button",{attrs:{type:"primary",shape:"round"},on:{click:e.handleSearch}},[e._v("search")])],1)],1)],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.teacherList,loading:e.loading,pagination:e.pagination,indentSize:30,scroll:{x:!0},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"avatar",fn:function(e){return a("span",{},[a("img",{staticClass:"avatar-img",attrs:{src:e}})])}},{key:"roles",fn:function(t){return a("div",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"grades",fn:function(t){return a("div",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"classes",fn:function(t){return a("div",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"groups",fn:function(t){return a("div",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"action",fn:function(t){return a("span",{staticClass:"table-action"},[2!==t.teacherStatus&&3!==t.teacherStatus?a("a-button",{attrs:{type:"primary",shape:"round",icon:"edit"},on:{click:function(a){return e.handleEdit(t)}}},[e._v(" Edit ")]):e._e(),2===t.teacherStatus?a("a-button",{attrs:{shape:"round"},on:{click:function(a){return e.handleApprove(t)}}},[e._v(" Approve ")]):e._e(),2===t.teacherStatus?a("a-button",{staticClass:"reject",attrs:{shape:"round"},on:{click:function(a){return e.handleReject(t)}}},[e._v(" Reject ")]):e._e(),2!==t.teacherStatus&&3!==t.teacherStatus?a("div",{staticClass:"more-action-wrapper action-item-wrapper"},[t.id!==e.info.id?a("a-dropdown",[a("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"more"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:"Delete this teacher ?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a",[a("a-icon",{attrs:{type:"delete",theme:"filled"}}),e._v(" Delete ")],1)])],1)],1)],1):e._e()],1):e._e()],1)}}])}),a("SchoolUserTeacherAdd",{ref:"modalForm",attrs:{roleList:e.roleList,groupList:e.groupList,classList:e.classList,gradeList:e.gradeList},on:{ok:e.loadData}})],1)},o=[],s=a("1da1"),c=a("5530"),l=(a("96cf"),a("99af"),a("7db0"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("j-modal",{directives:[{name:"show",rawName:"v-show",value:"add"===e.currentView,expression:"currentView === 'add'"}],attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===e.mode?"Add":"Save"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"add"===e.mode,expression:"mode === 'add'"}],staticClass:"invite-enter-btn"},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleInviteEnterBtn}},[e._v("Invite by link"),a("a-icon",{attrs:{type:"share-alt"}})],1)],1),a("a-form",{attrs:{form:e.form,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"First Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["firstname",{initialValue:e.getDefaultFormData.firstname,rules:[{required:!0,message:"Please input first name!"}]}],expression:"[\n                  'firstname',\n                  {\n                    initialValue: getDefaultFormData.firstname,\n                    rules: [{ required: true, message: 'Please input first name!' }],\n                  },\n                ]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Last Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lastname",{initialValue:e.getDefaultFormData.lastname,rules:[{required:!0,message:"Please input last name!"}]}],expression:"[\n                  'lastname',\n                  {\n                    initialValue: getDefaultFormData.lastname,\n                    rules: [{ required: true, message: 'Please input last name!' }],\n                  },\n                ]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Email"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{initialValue:e.getDefaultFormData.email,rules:[{required:!0,type:"email",message:"Please input email!"}]}],expression:"[\n                  'email',\n                  {\n                    initialValue: getDefaultFormData.email,\n                    rules: [{ required: true, type: 'email', message: 'Please input email!' }],\n                  },\n                ]"}],attrs:{disabled:"edit"===e.mode}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Role"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["roles",{initialValue:e.getDefaultFormData.roles,rules:[{required:!0,message:"Please select role!"}]}],expression:"[\n                  'roles',\n                  {\n                    initialValue: getDefaultFormData.roles,\n                    rules: [{ required: true, message: 'Please select role!' }],\n                  },\n                ]"}],attrs:{mode:"multiple"}},e._l(e.roleList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Group"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["groups",{initialValue:e.getDefaultFormData.groups,rules:[]}],expression:"['groups', { initialValue: getDefaultFormData.groups, rules: [] }]"}],attrs:{mode:"multiple"}},e._l(e.groupList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Class"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["classes",{initialValue:e.getDefaultFormData.classes,rules:[]}],expression:"['classes', { initialValue: getDefaultFormData.classes, rules: [] }]"}],attrs:{mode:"multiple"}},e._l(e.classList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Grade"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["grades",{initialValue:e.getDefaultFormData.grades,rules:[]}],expression:"['grades', { initialValue: getDefaultFormData.grades, rules: [] }]"}],attrs:{mode:"multiple"}},e._l(e.gradeList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Archived"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["archived",{initialValue:e.getDefaultFormData.archived,rules:[]}],expression:"[\n                  'archived',\n                  {\n                    initialValue: getDefaultFormData.archived,\n                    rules: [],\n                  },\n                ]"}]},[a("a-select-option",{attrs:{value:1}},[e._v(" True ")]),a("a-select-option",{attrs:{value:0}},[e._v(" False ")])],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Date of joining"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["schoolJoinDate",{initialValue:e.getDefaultFormData.schoolJoinDate,rules:[]}],expression:"['schoolJoinDate', { initialValue: getDefaultFormData.schoolJoinDate, rules: [] }]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Picture"}},[a("div",{staticClass:"ant-upload-preview",on:{click:function(t){return e.$refs.modal.edit(1)}}},[a("a-upload",{staticClass:"avatar-img",attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,openFileDialogOnClick:!1}},[this.avatar?a("img",{attrs:{src:this.avatar,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:e.uploadLoading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1)])],1)])],1)],1)],1)],1)],1),a("a-modal",{attrs:{title:"Invite by link",footer:null,visible:"invite"===e.currentView},on:{cancel:e.handleInviteBackBtn}},[a("a-spin",{attrs:{spinning:e.inviteLoading}},[a("div",{staticClass:"invite"},[a("div",{staticClass:"invite-link"},[a("div",{staticClass:"link-text"},[e._v(" "+e._s(e.inviteUrl)+" ")]),a("div",{staticClass:"action-copy",on:{click:e.onCopy}},[a("a-tooltip",{attrs:{placement:"top",title:"Copy link"}},[a("a-icon",{attrs:{type:"link"}})],1)],1)]),a("div",{staticClass:"invite-checkbox"},[a("a-checkbox",{attrs:{checked:e.inviteCheckBoxChecked},on:{change:e.onInviteCheckBoxChange}},[e._v(" Applicants with this link will need your approval to join your school community ")])],1),a("div",{staticClass:"invite-reset-btn"},[a("a-button",{attrs:{shape:"round",type:"primary",icon:"sync",loading:e.resetLoading},on:{click:e.handleInviteResetBtn}},[e._v(" Reset ")])],1)])])],1),a("avatar-modal",{ref:"modal",on:{ok:e.setAvatar}})],1)}),u=[],d=(a("d81d"),a("ad00")),m=a("4e8a"),p=a("4360"),h=a("823b"),f=a("8d90"),v=a("c1df"),g=a.n(v),b={name:"SchoolUserTeacherAdd",mixins:[],components:{JModal:d["a"],AvatarModal:f["a"]},props:{roleList:{type:Array,default:function(){return[]}},groupList:{type:Array,default:function(){return[]}},classList:{type:Array,default:function(){return[]}},gradeList:{type:Array,default:function(){return[]}}},data:function(){return{title:"Add Teacher",mode:"add",width:800,visible:!1,confirmLoading:!1,uploadLoading:!1,form:this.$form.createForm(this,{name:"teacherAdd"}),defaultData:{},avatar:void 0,currentView:"add",inviteCheckBoxChecked:!0,inviteUrl:"",resetLoading:!1,inviteLoading:!1,inviteCodeId:void 0}},created:function(){},watch:{defaultData:function(e){var t;this.avatar=null===e||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.avatar}},computed:{getDefaultFormData:function(){var e,t,a,n,r,i,o,s,c,l,u,d,m=this.defaultData,p=m.roles,h=void 0===p?[]:p,f=m.groups,v=void 0===f?[]:f,b=m.classes,w=void 0===b?[]:b,S=m.grades,y=void 0===S?[]:S,k=h.map((function(e){return e.name})),x=v.map((function(e){return e.id})),D=w.map((function(e){return e.id})),C=y.map((function(e){return e.id}));return{firstname:null===(e=this.defaultData)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.firstname,lastname:null===(a=this.defaultData)||void 0===a||null===(n=a.userInfo)||void 0===n?void 0:n.lastname,email:null===(r=this.defaultData)||void 0===r||null===(i=r.userInfo)||void 0===i?void 0:i.email,roles:k,groups:x,classes:D,grades:C,archived:4===(null===(o=this.defaultData)||void 0===o||null===(s=o.userInfo)||void 0===s?void 0:s.schoolUserStatus)?1:0,schoolJoinDate:null!==(c=this.defaultData)&&void 0!==c&&null!==(l=c.userInfo)&&void 0!==l&&l.schoolJoinDate?g()(null===(u=this.defaultData)||void 0===u||null===(d=u.userInfo)||void 0===d?void 0:d.schoolJoinDate):void 0}}},methods:{show:function(){this.visible=!0,this.currentView="add"},handleOk:function(){var e=this;this.form.validateFields(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a,n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=12;break}return e.confirmLoading=!0,r=Object(c["a"])({schoolId:p["a"].getters.school,avatar:e.avatar},n),n.roles&&n.roles.length>0&&(r.roles=n.roles.reduce((function(e,t){return"".concat(e,",").concat(t)}))),n.groups&&n.groups.length>0&&(r.groups=n.groups.reduce((function(e,t){return"".concat(e,",").concat(t)}))),n.classes&&n.classes.length>0&&(r.classes=n.classes.reduce((function(e,t){return"".concat(e,",").concat(t)}))),n.grades&&n.grades.length>0&&(r.grades=n.grades.reduce((function(e,t){return"".concat(e,",").concat(t)}))),n.schoolJoinDate&&(r.schoolJoinDate=g()(n.schoolJoinDate).valueOf()),t.next=10,Object(m["a"])(r);case 10:i=t.sent,i.success?(e.confirmLoading=!1,e.visible=!1,e.$emit("ok")):(e.confirmLoading=!1,e.$message.error(i.message));case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},handleCancel:function(){this.visible=!1,this.confirmLoading=!1},setAvatar:function(e){h["info"]("setAvatar "+e),this.avatar=e},getInviteUrl:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["d"])({schoolId:p["a"].getters.school,role:2,need_approve:t.inviteCheckBoxChecked?1:0,need_refresh:e});case 2:n=a.sent,null!==n&&void 0!==n&&n.success&&(t.inviteUrl="".concat("https://my.classcipe.com","/user/invite?inviteCode=").concat(null===n||void 0===n||null===(r=n.result)||void 0===r?void 0:r.inviteCode),t.inviteCheckBoxChecked=null===n||void 0===n||null===(i=n.result)||void 0===i?void 0:i.approveFlag,t.inviteCodeId=null===n||void 0===n||null===(o=n.result)||void 0===o?void 0:o.id);case 4:case"end":return a.stop()}}),a)})))()},handleInviteEnterBtn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.currentView="invite",e.inviteLoading=!0,t.next=4,e.getInviteUrl(0);case 4:e.inviteLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},handleInviteResetBtn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.resetLoading=!0,t.next=3,e.getInviteUrl(1);case 3:e.resetLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},handleInviteBackBtn:function(){this.currentView="add"},onInviteCheckBoxChange:function(e){this.inviteCheckBoxChecked=e.target.checked,this.updateInviteCode(e.target.checked)},updateInviteCode:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["k"])({need_approve:e?1:0,id:t.inviteCodeId});case 2:n=a.sent,n.success?t.inviteUrl="".concat("https://my.classcipe.com","/user/invite?inviteCode=").concat(null===n||void 0===n||null===(r=n.result)||void 0===r?void 0:r.inviteCode):t.$message.error(n.message);case 4:case"end":return a.stop()}}),a)})))()},onCopy:function(){var e=this;navigator.clipboard.writeText(this.inviteUrl).then((function(){e.$message.success("copy success!")}))}}},w=b,S=(a("9130"),a("d1a7"),a("0c7c")),y=Object(S["a"])(w,l,u,!1,null,"33fafaa8",null),k=y.exports,x=a("b775"),D={getSchoolGroupList:"/classcipe/api/school/group/list",addOrUpdateGroup:"/classcipe/api/school/group/addOrUpdate",getSchoolGroupMembers:"/classcipe/api/school/group/listGroupMembers",addSchoolGroupMembers:"/classcipe/api/school/group/addGroupMember",removeSchoolGroupMembers:"/classcipe/api/school/group/removeGroupMember"};function C(e){return Object(x["d"])({url:D.getSchoolGroupList,method:"get",params:e})}function I(e){return Object(x["d"])({url:D.addOrUpdateGroup,method:"post",data:e})}function _(e){return Object(x["d"])({url:D.getSchoolGroupMembers,method:"get",params:e})}function j(e){return Object(x["d"])({url:D.addSchoolGroupMembers,method:"get",params:e})}function L(e){return Object(x["d"])({url:D.removeSchoolGroupMembers,method:"get",params:e})}var O={GradeAddOrUpdate:"/classcipe/api/grade/addOrUpdate",GradeQueryById:"/classcipe/api/grade/queryById",GradeDelete:"/classcipe/api/grade/delete",GradeDeleteBatch:"/classcipe/api/grade/deleteBatch",GradeList:"/classcipe/api/grade/list",GradeBySchoolId:"/classcipe/api/grade/getGradesBySchoolId",GradeGetAllGrades:"/classcipe/api/grade/getAllGrades"};function R(e){return Object(x["d"])({url:O.GradeBySchoolId,method:"get",params:e})}var F=a("7483"),$=a("6757"),A=a("2f62"),U=[{title:"Picture",dataIndex:"userInfo.avatar",scopedSlots:{customRender:"avatar"},key:"avatar"},{title:"Name",dataIndex:"userInfo",customRender:function(e,t,a){return"".concat(e.firstname," ").concat(e.lastname)},key:"name"},{title:"Role",dataIndex:"roles",scopedSlots:{customRender:"roles"},key:"roles"},{title:"Email",dataIndex:"userInfo.email",key:"email"},{title:"Grade",dataIndex:"grades",scopedSlots:{customRender:"grades"},key:"grades"},{title:"Class",dataIndex:"classes",scopedSlots:{customRender:"classes"},key:"classes"},{title:"Groups",dataIndex:"groups",scopedSlots:{customRender:"groups"},key:"groups"},{title:"Date of join",dataIndex:"schoolJoinDate",customRender:function(e,t,a){return e?g()(e).format("YYYY-MM-DD"):""},key:"joinDate"},{title:"Status",dataIndex:"teacherStatus",customRender:function(e,t,a){var n;return null===(n=F["a"].find((function(t){return t.id===e})))||void 0===n?void 0:n.name},key:"status"},{title:"Action",key:"action",scopedSlots:{customRender:"action"},fixed:"right",width:100}],T={name:"SchoolUserTeacher",mixins:[],components:{SchoolUserTeacherAdd:k},data:function(){return{roleList:[],groupList:[],classList:[],gradeList:[],teacherList:[],columns:U,loading:!1,pagination:{pageSize:15,current:1,pageSizeOptions:["15","30","50"],showTotal:function(e,t){return"Total "+e+" items"},total:0},baseUrl:"",activeStatus:"",form:this.$form.createForm(this,{name:"teacherSearch"}),showAdvancedSearch:!1,importLoadingText:"Bulk import",importLoading:!1}},created:function(){this.initData()},computed:Object(c["a"])({},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{initData:function(){this.loadData(),this.loadRoleList(),this.loadGroupList(),this.loadClassList(),this.loadGradeList()},loadRoleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["f"])({schoolId:e.currentSchool.id});case 2:a=t.sent,e.roleList=(null===a||void 0===a?void 0:a.result)||[];case 4:case"end":return t.stop()}}),t)})))()},loadGroupList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C({schoolId:e.currentSchool.id});case 2:n=t.sent,e.groupList=(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.records)||[];case 4:case"end":return t.stop()}}),t)})))()},loadClassList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["e"])({schoolId:e.currentSchool.id});case 2:n=t.sent,e.classList=(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.records)||[];case 4:case"end":return t.stop()}}),t)})))()},loadGradeList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,R({schoolId:e.currentSchool.id});case 2:a=t.sent,e.gradeList=(null===a||void 0===a?void 0:a.result)||[];case 4:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r=e.form.getFieldsValue(),r.roles||(r.roles=$["a"].teacher),t.next=5,Object(m["g"])(Object(c["a"])({schoolId:p["a"].getters.school,pageSize:e.pagination.pageSize,pageNo:e.pagination.current,userStatus:e.activeStatus},r));case 5:i=t.sent,e.teacherList=(null===i||void 0===i||null===(a=i.result)||void 0===a?void 0:a.records)||[],e.pagination.total=null===i||void 0===i||null===(n=i.result)||void 0===n?void 0:n.total,e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()},handleChangeStatus:function(e){this.activeStatus=e,this.loadData()},handleSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=Object(c["a"])({},e.pagination),a.current=1,e.pagination=a,e.loadData();case 4:case"end":return t.stop()}}),t)})))()},handleReset:function(){this.form.resetFields()},handleAdvancedSearch:function(){this.showAdvancedSearch=!this.showAdvancedSearch},handleEdit:function(e){this.$refs.modalForm.title="Edit Teacher",this.$refs.modalForm.mode="edit",this.$refs.modalForm.defaultData=e,this.$refs.modalForm.show()},handleAdd:function(){this.$refs.modalForm.title="Add Teacher",this.$refs.modalForm.mode="add",this.$refs.modalForm.defaultData={},this.$refs.modalForm.show()},handleDelete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["i"])({schoolId:t.currentSchool.id,userId:e.id,role:$["a"].teacher});case 2:n=a.sent,n.success?(t.$message.success(n.message),t.loadData()):t.$message.error(n.message);case 4:case"end":return a.stop()}}),a)})))()},changeUserStatus:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(m["m"])({schoolId:a.currentSchool.id,schoolUserStatus:t,userId:e,role:$["a"].teacher});case 2:r=n.sent,r.success?(a.$message.success(r.message),a.loadData()):a.$message.error(r.message);case 4:case"end":return n.stop()}}),n)})))()},handleApprove:function(e){this.changeUserStatus(e.id,1)},handleReject:function(e){this.changeUserStatus(e.id,3)},handleTableChange:function(e){var t=Object(c["a"])({},this.pagination);t.current=e.current,this.pagination=t,this.loadData()},downloadTemplate:function(){var e=document.createElement("a");e.style.display="none";var t=this.baseUrl+"/classcipe/excel/school_staff_template.xls";e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(t)},handleMyImportExcel:function(e){var t=this,a=this.$createElement;h["info"]("import excel",e);var n=new FormData;n.append("file",e.file,e.file.name),this.importLoading=!0,this.$http.post(m["j"].importStaff,n,{contentType:!1,processData:!1,headers:{"Content-Type":"multipart/form-data"},timeout:6e4,params:{schoolId:this.currentSchool.id}}).then((function(e){if(h["info"]("import excel res:",e),e.success){var n=e.result,r=void 0===n?{}:n,i=r.invalidCount,o=r.totalCount,s=r.invalidDataKey;0===i?t.$success({title:"Import successfully"}):t.$warning({title:"A bit more patience is needed",content:a("div",[a("p",["Success Count: ",o-i]),a("p",["Invalid Count: ",i])]),okText:"Download the failed part",onOk:function(){var e=document.createElement("a"),t="".concat("").concat(m["j"].exportInvalidStaff,"?key=").concat(s);e.href=t,e.download="invalidStaff.xls",e.click(),URL.revokeObjectURL(t)}})}else t.$error({title:"Import failed",content:"Import failed. Please upload again!"})})).catch((function(e){h["info"]("import excel err:",e),t.$error({title:"Import failed",content:"Import failed. Please upload again!"})})).finally((function(){t.importLoading=!1,t.loadData()}))}}},N=T,G=(a("d5b4"),a("0205"),Object(S["a"])(N,i,o,!1,null,"45c7705c",null)),E=G.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"operator"},[a("div",{staticClass:"status-select"},[a("a",{class:{active:""===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("")}}},[a("span",[e._v("All")])]),a("a",{class:{active:"1"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("1")}}},[a("span",[e._v("Active")])]),a("a",{class:{active:"0,2"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("0,2")}}},[a("span",[e._v("Pending")])]),a("a",{class:{active:"4"===e.activeStatus},on:{click:function(t){return e.handleChangeStatus("4")}}},[a("span",[e._v("Archived")])])]),a("div",{staticClass:"upload-wrapper"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("Add")]),a("a-upload",{attrs:{name:"file",showUploadList:!1,multiple:!1,customRequest:e.handleMyImportExcel}},[a("a-button",{attrs:{loading:e.importLoading,type:"primary",icon:"import"}},[e._v(e._s(e.importLoadingText))])],1),a("a-dropdown",[a("a-button",{attrs:{type:"link",shape:"circle",icon:"download"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1"},[a("a-button",{attrs:{type:"link",icon:"download"},on:{click:e.downloadTemplate}},[e._v("Download template")])],1)],1)],1)],1)]),a("div",{staticClass:"search-box"},[a("a-form",{attrs:{form:e.form,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-item",{attrs:{label:""}},[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[]}],expression:"['name', { rules: [] }]"}],staticStyle:{width:"300px"},attrs:{placeholder:"Search for ID、Name、Email...","enter-button":""},on:{search:e.handleSearch}})],1)],1),a("a-col",{attrs:{span:4}},[a("div",{staticStyle:{"line-height":"32px","margin-top":"6px"}},[a("a",{on:{click:e.handleAdvancedSearch}},[a("span",[e._v(e._s(e.showAdvancedSearch?"General Search":"Advanced Search"))])])])])],1),a("a-card",{directives:[{name:"show",rawName:"v-show",value:e.showAdvancedSearch,expression:"showAdvancedSearch"}]},[a("a-row",[a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Class"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["classes",{rules:[]}],expression:"['classes', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.classList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",{attrs:{label:"Grade"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["grades",{rules:[]}],expression:"['grades', { rules: [] }]"}],attrs:{allowClear:""}},e._l(e.gradeList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("div",{staticClass:"search-box-btn"},[a("a-button",{attrs:{type:"primary",shape:"round"},on:{click:e.handleReset}},[e._v("reset")]),a("a-button",{attrs:{type:"primary",shape:"round"},on:{click:e.handleSearch}},[e._v("search")])],1)])],1)],1)],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.studentList,loading:e.loading,pagination:e.pagination,scroll:{x:!0},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"roles",fn:function(t){return a("span",{},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"grades",fn:function(t){return a("span",{},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"classes",fn:function(t){return a("span",{},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"groups",fn:function(t){return a("span",{},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"action",fn:function(t){return a("span",{staticClass:"table-action"},[2!==t.studentStatus&&3!==t.studentStatus?a("a-button",{attrs:{type:"primary",shape:"round",icon:"edit"},on:{click:function(a){return e.handleEdit(t)}}},[e._v(" Edit ")]):e._e(),2===t.studentStatus?a("a-button",{attrs:{shape:"round"},on:{click:function(a){return e.handleApprove(t)}}},[e._v(" Approve ")]):e._e(),2===t.studentStatus?a("a-button",{staticClass:"reject",attrs:{shape:"round"},on:{click:function(a){return e.handleReject(t)}}},[e._v(" Reject ")]):e._e(),2!==t.studentStatus&&3!==t.studentStatus?a("div",{staticClass:"more-action-wrapper action-item-wrapper"},[a("a-dropdown",[a("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"more"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:"Delete this student ?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a",[a("a-icon",{attrs:{type:"delete",theme:"filled"}}),e._v(" Delete ")],1)])],1)],1)],1)],1):e._e()],1)}}])}),a("SchoolUserStudentAdd",{ref:"modalForm",attrs:{classList:e.classList,gradeList:e.gradeList},on:{ok:e.loadData}})],1)},B=[],P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("j-modal",{directives:[{name:"show",rawName:"v-show",value:"add"===e.currentView,expression:"currentView === 'add'"}],attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===e.mode?"Add":"Save"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"add"===e.mode,expression:"mode === 'add'"}],staticClass:"invite-enter-btn"},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleInviteEnterBtn}},[e._v("Invite by link"),a("a-icon",{attrs:{type:"share-alt"}})],1)],1),a("a-form",{attrs:{form:e.form,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"First Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["firstname",{initialValue:e.getDefaultFormData.firstname,rules:[{required:!0,message:"Please input first name!"}]}],expression:"[\n                  'firstname',\n                  {\n                    initialValue: getDefaultFormData.firstname,\n                    rules: [{ required: true, message: 'Please input first name!' }],\n                  },\n                ]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Last Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lastname",{initialValue:e.getDefaultFormData.lastname,rules:[{required:!0,message:"Please input last name!"}]}],expression:"[\n                  'lastname',\n                  {\n                    initialValue: getDefaultFormData.lastname,\n                    rules: [{ required: true, message: 'Please input last name!' }],\n                  },\n                ]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Email"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{initialValue:e.getDefaultFormData.email,rules:[{required:!0,type:"email",message:"Please input email!"}]}],expression:"[\n                  'email',\n                  {\n                    initialValue: getDefaultFormData.email,\n                    rules: [{ required: true, type: 'email', message: 'Please input email!' }],\n                  },\n                ]"}],attrs:{disabled:"edit"===e.mode}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Student ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["workNo",{initialValue:e.getDefaultFormData.workNo,rules:[]}],expression:"['workNo', { initialValue: getDefaultFormData.workNo, rules: [] }]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Class"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["classes",{initialValue:e.getDefaultFormData.classes,rules:[]}],expression:"[\n                  'classes',\n                  {\n                    initialValue: getDefaultFormData.classes,\n                    rules: [],\n                  },\n                ]"}],on:{change:this.handleClasses}},e._l(e.classList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("div",{staticStyle:{height:"36px","margin-top":"8px"}},[e._v("Reletive Grade: "+e._s(this.reletiveGrade))])])],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Age"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["age",{initialValue:e.getDefaultFormData.age,rules:[]}],expression:"['age', { initialValue: getDefaultFormData.age, rules: [] }]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Parent Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentName",{initialValue:e.getDefaultFormData.parentName,rules:[]}],expression:"['parentName', { initialValue: getDefaultFormData.parentName, rules: [] }]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Parent Email"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentEmail",{initialValue:e.getDefaultFormData.parentEmail,rules:[{required:!1,type:"email",message:"Please input email!"}]}],expression:"[\n                  'parentEmail',\n                  {\n                    initialValue: getDefaultFormData.parentEmail,\n                    rules: [{ required: false, type: 'email', message: 'Please input email!' }],\n                  },\n                ]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Parent No"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentNo",{initialValue:e.getDefaultFormData.parentNo,rules:[]}],expression:"['parentNo', { initialValue: getDefaultFormData.parentNo, rules: [] }]"}]})],1)],1)],1)],1)],1)],1),a("a-modal",{attrs:{title:"Invite by link",footer:null,visible:"invite"===e.currentView},on:{cancel:e.handleInviteBackBtn}},[a("a-spin",{attrs:{spinning:e.inviteLoading}},[a("div",{staticClass:"invite"},[a("div",{staticClass:"invite-link"},[a("div",{staticClass:"link-text"},[e._v(" "+e._s(e.inviteUrl)+" ")]),a("div",{staticClass:"action-copy",on:{click:e.onCopy}},[a("a-tooltip",{attrs:{placement:"top",title:"Copy link"}},[a("a-icon",{attrs:{type:"link"}})],1)],1)]),a("div",{staticClass:"invite-checkbox"},[a("a-checkbox",{attrs:{checked:e.inviteCheckBoxChecked},on:{change:e.onInviteCheckBoxChange}},[e._v(" Applicants with this link will need your approval to join your school community ")])],1),a("div",{staticClass:"invite-reset-btn"},[a("a-button",{attrs:{shape:"round",type:"primary",icon:"sync",loading:e.resetLoading},on:{click:e.handleInviteResetBtn}},[e._v(" Reset ")])],1)])])],1)],1)},M=[],q={name:"SchoolUserStudentAdd",mixins:[],components:{JModal:d["a"]},props:{classList:{type:Array,default:function(){return[]}},gradeList:{type:Array,default:function(){return[]}}},data:function(){return{title:"Add Student",mode:"add",width:800,visible:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"studentAdd"}),defaultData:{},currentView:"add",inviteCheckBoxChecked:!0,inviteUrl:"",resetLoading:!1,inviteLoading:!1,reletiveGrade:"",inviteCodeId:void 0}},created:function(){},computed:Object(c["a"])({getDefaultFormData:function(){var e,t,a,n,r,i,o,s,c,l,u,d,m,p,h,f,v,g,b;return{firstname:null===(e=this.defaultData)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.firstname,lastname:null===(a=this.defaultData)||void 0===a||null===(n=a.userInfo)||void 0===n?void 0:n.lastname,email:null===(r=this.defaultData)||void 0===r||null===(i=r.userInfo)||void 0===i?void 0:i.email,workNo:null===(o=this.defaultData)||void 0===o||null===(s=o.userInfo)||void 0===s?void 0:s.workNo,classes:null===(c=this.defaultData)||void 0===c||null===(l=c.classes)||void 0===l||null===(u=l[0])||void 0===u?void 0:u.id,age:null===(d=this.defaultData)||void 0===d||null===(m=d.userInfo)||void 0===m?void 0:m.age,parentName:null===(p=this.defaultData)||void 0===p||null===(h=p.userInfo)||void 0===h?void 0:h.parentName,parentEmail:null===(f=this.defaultData)||void 0===f||null===(v=f.userInfo)||void 0===v?void 0:v.parentEmail,parentNo:null===(g=this.defaultData)||void 0===g||null===(b=g.userInfo)||void 0===b?void 0:b.parentNo}}},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{show:function(){this.visible=!0,this.currentView="add"},handleOk:function(){var e=this;this.form.validateFields(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=6;break}return e.confirmLoading=!0,t.next=4,Object(m["b"])(Object(c["a"])({schoolId:e.currentSchool.id},n));case 4:r=t.sent,r.success?(e.confirmLoading=!1,e.visible=!1,e.$emit("ok")):(e.$message.error(r.message),e.confirmLoading=!1);case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},handleCancel:function(){this.visible=!1,this.confirmLoading=!1},getInviteUrl:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["d"])({schoolId:t.currentSchool.id,role:4,need_approve:t.inviteCheckBoxChecked?1:0,need_refresh:e});case 2:n=a.sent,null!==n&&void 0!==n&&n.success&&(t.inviteUrl="".concat("https://my.classcipe.com","/user/invite?inviteCode=").concat(null===n||void 0===n||null===(r=n.result)||void 0===r?void 0:r.inviteCode),t.inviteCheckBoxChecked=null===n||void 0===n||null===(i=n.result)||void 0===i?void 0:i.approveFlag,t.inviteCodeId=null===n||void 0===n||null===(o=n.result)||void 0===o?void 0:o.id);case 4:case"end":return a.stop()}}),a)})))()},handleInviteEnterBtn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.currentView="invite",e.inviteLoading=!0,t.next=4,e.getInviteUrl(0);case 4:e.inviteLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},handleInviteResetBtn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.resetLoading=!0,t.next=3,e.getInviteUrl(1);case 3:e.resetLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},handleInviteBackBtn:function(){this.currentView="add"},onInviteCheckBoxChange:function(e){this.inviteCheckBoxChecked=e.target.checked,this.updateInviteCode(e.target.checked)},updateInviteCode:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["k"])({need_approve:e?1:0,id:t.inviteCodeId});case 2:n=a.sent,n.success?t.inviteUrl="".concat("https://my.classcipe.com","/user/invite?inviteCode=").concat(null===n||void 0===n||null===(r=n.result)||void 0===r?void 0:r.inviteCode):t.$message.error(n.message);case 4:case"end":return a.stop()}}),a)})))()},onCopy:function(){var e=this;navigator.clipboard.writeText(this.inviteUrl).then((function(){e.$message.success("copy success!")}))},handleClasses:function(e){var t=this.classList.find((function(t){return t.id===e}));t&&(this.reletiveGrade=t.gradeName)}}},z=q,J=(a("fd13"),a("34da"),Object(S["a"])(z,P,M,!1,null,"1801e041",null)),Y=J.exports,K=[{title:"Student ID",dataIndex:"userInfo.workNo",key:"id"},{title:"Name",dataIndex:"userInfo",customRender:function(e,t,a){return"".concat(e.firstname," ").concat(e.lastname)},key:"name"},{title:"Email",dataIndex:"userInfo.email",key:"email"},{title:"Grade",dataIndex:"grades",scopedSlots:{customRender:"grades"},key:"grades"},{title:"Class",dataIndex:"classes",scopedSlots:{customRender:"classes"},key:"classes"},{title:"Age",dataIndex:"userInfo.age",key:"age"},{title:"Parent name",dataIndex:"userInfo.parentName",key:"parentName"},{title:"Parent email",dataIndex:"userInfo.parentEmail",key:"parentEmail"},{title:"Parent No",dataIndex:"userInfo.parentNo",key:"parentNo"},{title:"Status",dataIndex:"studentStatus",customRender:function(e,t,a){var n;return null===(n=F["a"].find((function(t){return t.id===e})))||void 0===n?void 0:n.name},key:"status"},{title:"Action",key:"action",scopedSlots:{customRender:"action"},fixed:"right",width:100}],H={name:"SchoolUserStudent",mixins:[],components:{SchoolUserStudentAdd:Y},data:function(){return{classList:[],gradeList:[],studentList:[],columns:K,loading:!1,pagination:{pageSize:15,current:1,pageSizeOptions:["15","30","50"],showTotal:function(e,t){return"Total "+e+" items"},total:0},baseUrl:"",activeStatus:"",form:this.$form.createForm(this,{name:"teacherSearch"}),showAdvancedSearch:!1,importLoadingText:"Bulk import",importLoading:!1}},created:function(){this.initData()},computed:Object(c["a"])({},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{initData:function(){this.loadData(),this.loadClassList(),this.loadGradeList()},loadClassList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["e"])({schoolId:e.currentSchool.id});case 2:n=t.sent,e.classList=(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.records)||[];case 4:case"end":return t.stop()}}),t)})))()},loadGradeList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,R({schoolId:e.currentSchool.id});case 2:a=t.sent,e.gradeList=(null===a||void 0===a?void 0:a.result)||[];case 4:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r=e.form.getFieldsValue(),t.next=4,Object(m["g"])(Object(c["a"])({schoolId:p["a"].getters.school,roles:$["a"].student,pageSize:e.pagination.pageSize,pageNo:e.pagination.current,userStatus:e.activeStatus},r));case 4:i=t.sent,e.studentList=(null===i||void 0===i||null===(a=i.result)||void 0===a?void 0:a.records)||[],e.pagination.total=null===i||void 0===i||null===(n=i.result)||void 0===n?void 0:n.total,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},handleChangeStatus:function(e){this.activeStatus=e,this.loadData()},handleSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=Object(c["a"])({},e.pagination),a.current=1,e.pagination=a,e.loadData();case 4:case"end":return t.stop()}}),t)})))()},handleReset:function(){this.form.resetFields()},handleAdvancedSearch:function(){this.showAdvancedSearch=!this.showAdvancedSearch},handleTableChange:function(e){var t=Object(c["a"])({},this.pagination);t.current=e.current,this.pagination=t,this.loadData()},handleEdit:function(e){this.$refs.modalForm.title="Edit Student",this.$refs.modalForm.mode="edit",this.$refs.modalForm.defaultData=e,this.$refs.modalForm.show()},handleAdd:function(){this.$refs.modalForm.title="Add Student",this.$refs.modalForm.mode="add",this.$refs.modalForm.defaultData={},this.$refs.modalForm.show()},handleDelete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["i"])({schoolId:t.currentSchool.id,userId:e.id,role:$["a"].student});case 2:n=a.sent,n.success?(t.$message.success(n.message),t.loadData()):t.$message.error(n.message);case 4:case"end":return a.stop()}}),a)})))()},changeUserStatus:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(m["m"])({schoolId:a.currentSchool.id,schoolUserStatus:t,userId:e,role:$["a"].student});case 2:r=n.sent,r.success?(a.$message.success(r.message),a.loadData()):a.$message.error(r.message);case 4:case"end":return n.stop()}}),n)})))()},handleApprove:function(e){this.changeUserStatus(e.id,1)},handleReject:function(e){this.changeUserStatus(e.id,3)},downloadTemplate:function(){var e=document.createElement("a");e.style.display="none";var t=this.baseUrl+"/classcipe/excel/school_students_template.xls";e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(t)},handleMyImportExcel:function(e){var t=this,a=this.$createElement;h["info"]("import excel",e);var n=new FormData;n.append("file",e.file,e.file.name),this.importLoading=!0,this.$http.post(m["j"].importStudent,n,{contentType:!1,processData:!1,headers:{"Content-Type":"multipart/form-data"},timeout:6e4,params:{schoolId:this.currentSchool.id}}).then((function(e){if(h["info"]("import excel res:",e),e.success){var n=e.result,r=void 0===n?{}:n,i=r.invalidCount,o=r.totalCount,s=r.invalidDataKey;0===i?t.$success({title:"Import successfully"}):t.$warning({title:"A bit more patience is needed",content:a("div",[a("p",["Success Count: ",o-i]),a("p",["Invalid Count: ",i])]),okText:"Download the failed part",onOk:function(){var e=document.createElement("a"),t="".concat("").concat(m["j"].exportInvalidStudent,"?key=").concat(s);e.href=t,e.download="invalidStudent.xls",e.click(),URL.revokeObjectURL(t)}})}else t.$error({title:"Import failed",content:"Import failed. Please upload again!"})})).catch((function(e){h["info"]("import excel err:",e),t.$error({title:"Import failed",content:"Import failed. Please upload again!"})})).finally((function(){t.importLoading=!1,t.loadData()}))}}},Q=H,W=(a("ce64"),a("2bdd"),Object(S["a"])(Q,V,B,!1,null,"625aeb73",null)),X=W.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"operator"},[a("a-col",{attrs:{span:12}},[a("div",{staticClass:"search-box"},[a("a-form",{attrs:{form:e.form,"label-col":{span:14},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:14}},[a("a-form-item",{attrs:{label:""}},[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[]}],expression:"['name', { rules: [] }]"}],staticStyle:{width:"300px"},attrs:{placeholder:"Search for ID、Name、Email...","enter-button":""},on:{search:e.handleSearch}})],1)],1)],1)],1)],1)]),a("a-col",{attrs:{span:8}},[e.isAdd?a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%"},attrs:{size:"large",placeholder:"Search and add by name/email","option-label-prop":"title"},on:{focus:e.handleSearchTeacher,select:e.onSelect,search:e.handleSearchTeacher},model:{value:e.selectTeacher,callback:function(t){e.selectTeacher=t},expression:"selectTeacher"}},[a("template",{slot:"dataSource"},e._l(e.optionsList,(function(t){return a("a-select-option",{key:t.userInfo.id,attrs:{title:t.userInfo.email}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"user-avatar"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.userInfo.avatar}})])]),a("div",{staticClass:"user-name-email"},[a("div",{staticClass:"user-name"},[e._v(" "+e._s(t.userInfo.nickname)+" ")]),a("div",{staticClass:"email"},[e._v(" "+e._s(t.userInfo.email)+" ")])]),a("div",{staticClass:"action-wrapper"},[a("a-button",{attrs:{type:"link"},on:{click:function(a){return e.handleAddTeacher(t.userInfo)}}},[e._v(" Add ")])],1)])])})),1),a("a-input",[a("a-icon",{staticClass:"certain-category-icon",attrs:{slot:"suffix",type:"search"},slot:"suffix"})],1)],2):e._e()],1),a("div",{staticClass:"upload-wrapper"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){e.isAdd=!0}}},[e._v("Add")])],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.adminList,loading:e.loading,pagination:e.pagination,scroll:{x:!0},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"roles",fn:function(t){return a("span",{},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"avatar",fn:function(e){return a("span",{},[a("img",{staticClass:"avatar-img",attrs:{src:e}})])}},{key:"action",fn:function(t){return a("span",{staticClass:"table-action"},[t.id!==e.info.id?a("a-popconfirm",{attrs:{title:"Remove this admin ?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a-button",{attrs:{shape:"round",icon:"delete"}},[e._v(" Remove ")])],1):e._e()],1)}}])})],1)},ee=[],te=(a("4de4"),[{title:"Picture",dataIndex:"userInfo.avatar",scopedSlots:{customRender:"avatar"},key:"avatar"},{title:"Name",dataIndex:"userInfo",customRender:function(e,t,a){return"".concat(e.firstname," ").concat(e.lastname)},key:"name"},{title:"Email",dataIndex:"userInfo.email",key:"email"},{title:"Lasted Accessed",dataIndex:"schoolJoinDate",customRender:function(e,t,a){return e?g()(e).format("YYYY-MM-DD"):""},key:"joinDate"},{title:"Action",key:"action",scopedSlots:{customRender:"action"},width:"180px"}]),ae={name:"SchoolUserAdmin",mixins:[],components:{SchoolUserStudentAdd:Y},data:function(){return{teacherList:[],optionsList:[],selectTeacher:"",adminList:[],columns:te,loading:!1,isAdd:!1,pagination:{pageSize:15,current:1,pageSizeOptions:["15","30","50"],showTotal:function(e,t){return"Total "+e+" items"},total:0},baseUrl:"",form:this.$form.createForm(this,{name:"teacherSearch"})}},created:function(){this.initData()},computed:Object(c["a"])({selectedEmails:function(){return this.adminList.map((function(e){return e.userInfo.email}))}},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{initData:function(){var e=this;this.getTeacherList(),this.loadData(),this.optionsList=this.teacherList.filter((function(t){return-1===e.selectedEmails.indexOf(t.userInfo.email)}))},onSelect:function(e){},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r=e.form.getFieldsValue(),t.next=4,Object(m["g"])(Object(c["a"])({schoolId:e.currentSchool.id,roles:$["a"].admin,pageSize:e.pagination.pageSize,pageNo:e.pagination.current,userStatus:e.activeStatus},r));case 4:i=t.sent,e.adminList=(null===i||void 0===i||null===(a=i.result)||void 0===a?void 0:a.records)||[],e.pagination.total=null===i||void 0===i||null===(n=i.result)||void 0===n?void 0:n.total,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},getTeacherList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["g"])({schoolId:e.currentSchool.id,roles:$["a"].teacher,pageSize:1e3});case 2:a=t.sent,e.$logger.info("getTeacherList",a.result),e.teacherList=a.result?a.result.records:[];case 5:case"end":return t.stop()}}),t)})))()},handleSearch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=Object(c["a"])({},e.pagination),a.current=1,e.pagination=a,e.loadData();case 4:case"end":return t.stop()}}),t)})))()},handleTableChange:function(e){var t=Object(c["a"])({},this.pagination);t.current=e.current,this.pagination=t,this.loadData()},handleReset:function(){this.form.resetFields()},handleEdit:function(e){this.$refs.modalForm.title="Edit Student",this.$refs.modalForm.mode="edit",this.$refs.modalForm.defaultData=e,this.$refs.modalForm.show()},handleAdd:function(){this.$refs.modalForm.title="Add Student",this.$refs.modalForm.mode="add",this.$refs.modalForm.defaultData={},this.$refs.modalForm.show()},handleDelete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["i"])({schoolId:t.currentSchool.id,userId:e.id,role:$["a"].admin});case 2:n=a.sent,n.success?(t.$message.success(n.message),t.loadData()):t.$message.error(n.message);case 4:case"end":return a.stop()}}),a)})))()},handleSearchTeacher:function(e){var t=this;this.optionsList=e?this.teacherList.filter((function(a){return-1===t.selectedEmails.indexOf(e)&&a.userInfo.email.indexOf(e)>-1})):this.teacherList.filter((function(e){return-1===t.selectedEmails.indexOf(e.userInfo.email)}))},handleAddTeacher:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.confirmLoading=!0,n=Object(c["a"])(Object(c["a"])({schoolId:t.currentSchool.id,avatar:t.avatar},e),{},{roles:$["a"].admin,email:e.email}),a.next=4,Object(m["a"])(n);case 4:r=a.sent,r.success?(t.confirmLoading=!1,t.isAdd=!1,t.loadData()):(t.confirmLoading=!1,t.$message.error(r.message));case 6:case"end":return a.stop()}}),a)})))()}}},ne=ae,re=(a("d1c8"),Object(S["a"])(ne,Z,ee,!1,null,"4c9ef9c3",null)),ie=re.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"operator"},[a("div"),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("Add")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.groupList,loading:e.loading,pagination:e.pagination,scroll:{x:!0},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"advisor",fn:function(t){return a("span",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.email)+" ")])})),0)}},{key:"action",fn:function(t){return a("span",{staticClass:"table-action"},[a("a-button",{attrs:{type:"primary",shape:"round"},on:{click:function(a){return e.handleView(t)}}},[e._v(" View ")]),a("a-button",{attrs:{type:"primary",shape:"round",icon:"edit"},on:{click:function(a){return e.handleEdit(t)}}},[e._v(" Edit ")]),a("div",{staticClass:"more-action-wrapper action-item-wrapper"},[a("a-dropdown",[a("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"more"}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:"Delete this group ?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a",[a("a-icon",{attrs:{type:"delete",theme:"filled"}}),e._v(" Delete ")],1)])],1)],1)],1)],1)],1)}}])}),a("SchoolUserGroupAdd",{ref:"modalForm",attrs:{teacherList:e.teacherList},on:{ok:e.loadData}}),a("SchoolUserGroupMember",{ref:"modalMemberForm",attrs:{teacherList:e.teacherList},on:{ok:e.loadData}})],1)},se=[],ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("j-modal",{attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===e.mode?"Add":"Save"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Group Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.getDefaultFormData.name,rules:[{required:!0,message:"Please input group name!"}]}],expression:"[\n                  'name',\n                  {\n                    initialValue: getDefaultFormData.name,\n                    rules: [{ required: true, message: 'Please input group name!' }],\n                  },\n                ]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Group Type"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["groupType",{initialValue:e.getDefaultFormData.groupType,rules:[{required:!0,message:"Please select group type!"}]}],expression:"[\n                  'groupType',\n                  {\n                    initialValue: getDefaultFormData.groupType,\n                    rules: [{ required: true, message: 'Please select group type!' }],\n                  },\n                ]"}],on:{change:this.handelChangeGroupType}},e._l(e.schoolGroupTypeList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)],1),a("a-row",[1===this.groupType?a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Year"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["relationId",{initialValue:e.getDefaultFormData.relationId,rules:[]}],expression:"[\n                  'relationId',\n                  {\n                    initialValue: getDefaultFormData.relationId,\n                    rules: [],\n                  },\n                ]"}]},e._l(e.gradeList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1):e._e(),2===this.groupType?a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Subject"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["relationId",{initialValue:e.getDefaultFormData.relationId,rules:[]}],expression:"[\n                  'relationId',\n                  {\n                    initialValue: getDefaultFormData.relationId,\n                    rules: [],\n                  },\n                ]"}]},e._l(e.subjectList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1):e._e()],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"Advisor","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["advisor",{initialValue:e.getDefaultFormData.advisor,rules:[]}],expression:"[\n                  'advisor',\n                  {\n                    initialValue: getDefaultFormData.advisor,\n                    rules: [],\n                  },\n                ]"}],staticStyle:{width:"100%"},attrs:{mode:"multiple","label-in-value":!1,"filter-option":!1,"option-label-prop":"label"},on:{search:e.handleSearch,focus:e.handleSearch}},e._l(e.dataSource,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id,label:t.userInfo.email}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"user-avatar"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.userInfo.avatar}})])]),a("div",{staticClass:"user-name-email"},[a("div",{staticClass:"user-name"},[e._v(" "+e._s(t.userInfo.nickname)+" ")]),a("div",{staticClass:"email"},[e._v(" "+e._s(t.userInfo.email)+" ")])])])])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"Intro","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.getDefaultFormData.intro,rules:[]}],expression:"['intro', { initialValue: getDefaultFormData.intro, rules: [] }]"}]})],1)],1)],1)],1)],1)],1)],1)},le=[],ue=a("2909"),de=(a("159b"),[{id:0,name:"Standard Groups"},{id:1,name:"Year Groups"},{id:2,name:"Subject Groups"}]),me=a("c418"),pe={name:"SchoolUserGroupAdd",mixins:[],components:{JModal:d["a"]},props:{teacherList:{type:Array,default:function(){return[]}}},data:function(){return{title:"Add Group",mode:"add",width:800,visible:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"groupAdd"}),defaultData:{},schoolGroupTypeList:de,groupType:0,gradeList:[],subjectList:[],dataSource:this.teacherList}},created:function(){this.loadGradeList(),this.loadSubjectList()},watch:{defaultData:function(e){this.groupType=null===e||void 0===e?void 0:e.groupType}},computed:Object(c["a"])({getDefaultFormData:function(){var e,t,a,n,r=this.defaultData.advisor,i=void 0===r?[]:r,o=i.map((function(e){return e.id}));return{name:null===(e=this.defaultData)||void 0===e?void 0:e.name,groupType:null===(t=this.defaultData)||void 0===t?void 0:t.groupType,relationId:null===(a=this.defaultData)||void 0===a?void 0:a.relationId,advisor:o,intro:null===(n=this.defaultData)||void 0===n?void 0:n.intro}}},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{show:function(){this.visible=!0},loadGradeList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,R({schoolId:e.currentSchool.id});case 2:a=t.sent,e.gradeList=(null===a||void 0===a?void 0:a.result)||[];case 4:case"end":return t.stop()}}),t)})))()},loadSubjectList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(me["SubjectTree"])({schoolId:e.currentSchool.id});case 2:a=t.sent,n=function e(t){var a=[];return t.forEach((function(t){t.children&&t.children.length>0?a=[].concat(Object(ue["a"])(a),Object(ue["a"])(e(t.children))):a.push(t)})),a},e.subjectList=n((null===a||void 0===a?void 0:a.result)||[]);case 5:case"end":return t.stop()}}),t)})))()},handleOk:function(){var e=this;this.form.validateFields(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a,n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=8;break}return e.confirmLoading=!0,r=Object(c["a"])({schoolId:e.currentSchool.id},n),"edit"===e.mode&&(r.id=e.defaultData.id),t.next=6,I(r);case 6:i=t.sent,i.success?(e.confirmLoading=!1,e.visible=!1,e.$emit("ok")):(e.confirmLoading=!1,e.$message.error(i.message));case 8:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},handleCancel:function(){this.visible=!1,this.confirmLoading=!1},handelChangeGroupType:function(e){this.groupType=e},handleSearch:function(e){this.dataSource=e?this.teacherList.filter((function(t){return t.userInfo.email.indexOf(e)>-1})):this.teacherList}}},he=pe,fe=(a("1286"),a("3009"),Object(S["a"])(he,ce,le,!1,null,"7fa42e0c",null)),ve=fe.exports,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,footer:null},on:{cancel:e.handleCancel}},[a("div",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-auto-complete",{staticStyle:{width:"100%","margin-bottom":"16px"},attrs:{size:"large",placeholder:"Search here to add member","option-label-prop":"title"},on:{focus:e.handleSearch,search:e.handleSearch}},[a("template",{slot:"dataSource"},e._l(e.dataSource,(function(t){return a("a-select-option",{key:t.id,attrs:{title:t.userInfo.email}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"user-avatar"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.userInfo.avatar}})])]),a("div",{staticClass:"user-name-email"},[a("div",{staticClass:"user-name"},[e._v(" "+e._s(t.userInfo.nickname)+" ")]),a("div",{staticClass:"email"},[e._v(" "+e._s(t.userInfo.email)+" ")])]),a("div",{staticClass:"action-wrapper"},[a("a-button",{attrs:{type:"link"},on:{click:function(a){return e.handleAdd(t.userInfo)}}},[e._v(" Add ")])],1)])])})),1),a("a-input",[a("a-icon",{staticClass:"certain-category-icon",attrs:{slot:"suffix",type:"search"},slot:"suffix"})],1)],2)],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.memberList,loading:e.loading,pagination:e.pagination,scroll:{x:!0},rowKey:"id"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"classes",fn:function(t){return a("div",{staticClass:"table-tag"},e._l(t,(function(t){return a("span",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),0)}},{key:"action",fn:function(t){return a("span",{staticClass:"table-action"},[a("a-popconfirm",{attrs:{title:"Remove this teacher ?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return e.handleRemove(t)}}},[a("a",{attrs:{href:"#"}},[e._v("Remove")])])],1)}}])})],1)])},be=[],we=[{title:"Teacher Name",dataIndex:"userInfo",customRender:function(e,t,a){return"".concat(e.firstname," ").concat(e.lastname)},key:"name"},{title:"Class",dataIndex:"classes",scopedSlots:{customRender:"classes"},key:"classes"},{title:"Join at",dataIndex:"schoolJoinDate",key:"joinat"},{title:"Action",key:"action",scopedSlots:{customRender:"action"},width:"150px"}],Se={name:"SchoolUserGroupMember",mixins:[],components:{},props:{teacherList:{type:Array,default:function(){return[]}}},data:function(){return{title:"",width:800,visible:!1,confirmLoading:!1,defaultData:{},groupId:void 0,columns:we,loading:!1,pagination:{pageSize:15,current:1,pageSizeOptions:["15","30","50"],showTotal:function(e,t){return"Total "+e+" items"},total:0},dataSource:[],memberList:[]}},created:function(){},watch:{defaultData:function(e){e&&(this.groupId=e.id,this.title="Group: "+e.name,this.loadData())}},computed:Object(c["a"])({},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{show:function(){this.visible=!0},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,_({schoolId:e.currentSchool.id,groupId:e.groupId});case 3:a=t.sent,e.memberList=(null===a||void 0===a?void 0:a.result)||[],e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},handleCancel:function(){this.visible=!1,this.confirmLoading=!1,this.$emit("ok")},handleTableChange:function(e){var t=Object(c["a"])({},this.pagination);t.current=e.current,this.pagination=t,this.loadData()},handleRemove:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,L({schoolId:t.currentSchool.id,groupId:t.groupId,userId:e.id});case 2:n=a.sent,n.success?(t.$message.success(n.message),t.loadData()):t.$message.warning(n.message);case 4:case"end":return a.stop()}}),a)})))()},handleAdd:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,j({schoolId:t.currentSchool.id,groupId:t.groupId,userId:e.id});case 2:n=a.sent,n.success?(t.$message.success(n.message),t.loadData()):t.$message.warning(n.message);case 4:case"end":return a.stop()}}),a)})))()},handleSearch:function(e){this.dataSource=e?this.teacherList.filter((function(t){return t.userInfo.email.indexOf(e)>-1})):this.teacherList}}},ye=Se,ke=(a("a259"),a("d3ef"),Object(S["a"])(ye,ge,be,!1,null,"d7f26312",null)),xe=ke.exports,De=[{title:"Name",dataIndex:"name",key:"name"},{title:"Members",dataIndex:"memberCount",key:"members"},{title:"Group type",dataIndex:"groupType",customRender:function(e,t,a){var n;return null===(n=de.find((function(t){return t.id===e})))||void 0===n?void 0:n.name},key:"groupType"},{title:"Advisor",dataIndex:"advisor",scopedSlots:{customRender:"advisor"},key:"advisor"},{title:"Action",key:"action",scopedSlots:{customRender:"action"},width:"150px"}],Ce={name:"SchoolUserGroup",mixins:[],components:{SchoolUserGroupAdd:ve,SchoolUserGroupMember:xe},data:function(){return{groupList:[],columns:De,loading:!1,pagination:{pageSize:15,current:1,pageSizeOptions:["15","30","50"],showTotal:function(e,t){return"Total "+e+" items"},total:0},teacherList:[]}},created:function(){this.initData()},computed:Object(c["a"])({},Object(A["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool}})),methods:{initData:function(){this.loadData(),this.loadTeacherList()},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,C({schoolId:e.currentSchool.id});case 3:n=t.sent,e.groupList=(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.records)||[],e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},loadTeacherList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["g"])({schoolId:p["a"].getters.school,roles:$["a"].teacher,pageSize:1e3,userStatus:"1"});case 2:n=t.sent,e.teacherList=(null===n||void 0===n||null===(a=n.result)||void 0===a?void 0:a.records)||[];case 4:case"end":return t.stop()}}),t)})))()},handleTableChange:function(e){var t=Object(c["a"])({},this.pagination);t.current=e.current,this.pagination=t,this.loadData()},handleAdd:function(){this.$refs.modalForm.title="Add Group",this.$refs.modalForm.mode="add",this.$refs.modalForm.defaultData={},this.$refs.modalForm.show()},handleView:function(e){this.$refs.modalMemberForm.title="",this.$refs.modalMemberForm.defaultData=e,this.$refs.modalMemberForm.show()},handleEdit:function(e){this.$refs.modalForm.title="Edit Group",this.$refs.modalForm.mode="edit",this.$refs.modalForm.defaultData=e,this.$refs.modalForm.show()},handleSearch:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=Object(c["a"])({},t.pagination),r.current=1,t.pagination=r,t.loading=!0,a.next=6,C({schoolId:t.currentSchool.id,name:e});case 6:i=a.sent,t.groupList=(null===i||void 0===i||null===(n=i.result)||void 0===n?void 0:n.records)||[],t.loading=!1;case 9:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){}}},Ie=Ce,_e=(a("09a06"),a("dc57e"),Object(S["a"])(Ie,oe,se,!1,null,"2c210064",null)),je=_e.exports,Le=a("6e84"),Oe=a("21fb"),Re={name:"SchoolUser",mixins:[Le["a"],Oe["a"]],components:{SchoolUserTeacher:E,SchoolUserStudent:X,SchoolUserAdmin:ie,SchoolUserGroup:je},data:function(){return{currentStatus:"teacher"}},created:function(){},computed:{},methods:{handleSchoolChange:function(e){this.$refs[this.currentStatus+"Ref"]&&this.$refs[this.currentStatus+"Ref"].initData()},toggleStatus:function(e){this.currentStatus=e}}},Fe=Re,$e=(a("be93"),Object(S["a"])(Fe,n,r,!1,null,"33f1e449",null));t["default"]=$e.exports},be93:function(e,t,a){"use strict";a("2f5d")},c418:function(e,t,a){"use strict";a.r(t),a.d(t,"subjectAPIUrl",(function(){return r})),a.d(t,"SubjectTree",(function(){return i})),a.d(t,"SubjectAddOrUpdate",(function(){return o})),a.d(t,"SubjectQueryById",(function(){return s})),a.d(t,"SubjectDelete",(function(){return c})),a.d(t,"SubjectDeleteBatch",(function(){return l})),a.d(t,"SubjectList",(function(){return u})),a.d(t,"SubjectStudentList",(function(){return d}));var n=a("b775"),r={SubjectTree:"/classcipe/api/subject/tree",SubjectAddOrUpdate:"/classcipe/api/subject/addOrUpdate",SubjectQueryById:"/classcipe/api/subject/queryById",SubjectDelete:"/classcipe/api/subject/delete",SubjectDeleteBatch:"/classcipe/api/subject/deleteBatch",SubjectList:"/classcipe/api/subject/list",SubjectStudentList:"/classcipe/api/subject/getStudentSubjects"};function i(e){return Object(n["d"])({url:r.SubjectTree,method:"get",params:e})}function o(e){return Object(n["d"])({url:r.SubjectAddOrUpdate,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(e){return Object(n["d"])({url:r.SubjectQueryById,method:"get",params:e})}function c(e){return Object(n["d"])({url:r.SubjectDelete,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(n["d"])({url:r.SubjectDeleteBatch,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(n["d"])({url:r.SubjectList,method:"get",params:e})}function d(e){return Object(n["d"])({url:r.SubjectStudentList,method:"get",params:e})}},c5b0:function(e,t,a){},c60b:function(e,t,a){},ce64:function(e,t,a){"use strict";a("fd59")},cfae:function(e,t,a){},d1a7:function(e,t,a){"use strict";a("1cde")},d1c8:function(e,t,a){"use strict";a("c5b0")},d3ef:function(e,t,a){"use strict";a("9eec")},d5b4:function(e,t,a){"use strict";a("35ed")},dc57e:function(e,t,a){"use strict";a("c60b")},e305:function(e,t,a){},e611:function(e,t,a){},ec1a:function(e,t,a){},fd13:function(e,t,a){"use strict";a("55ee")},fd59:function(e,t,a){}}]);