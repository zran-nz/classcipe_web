(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079dc372"],{"0fac":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("85b1"),o=a("ca00"),n=a("8ded"),s=a.n(n),c={data:function(){return{saving:!1,saveTime:null,asyncSaveDataFn:null,autoSaveLocalKey:"FORM_",needAutoSave:!1}},created:function(){this.asyncSaveDataFn=Object(r["a"])(this.autoSaveLocalData,200)},watch:{formModel:{deep:!0,handler:function(e,t){this.needAutoSave&&this.asyncSaveDataFn(e)}}},computed:{lastChangeSavedTime:function(){var e=this.saveTime||this.form&&(this.form.updateTime||this.form.createTime);return e?Object(o["formatLocalUTC"])(e):""}},methods:{autoSaveLocalData:function(e){var t=this.$store.getters.userInfo.id,a=this.$store.state.user.currentSchool.id;s.a.set(this.autoSaveLocalKey+t+a,JSON.stringify(e))},getAutoLocalData:function(){var e=this.$store.getters.userInfo.id,t=this.$store.state.user.currentSchool.id,a=s.a.get(this.autoSaveLocalKey+e+t);return a?JSON.parse(a):{}},clearLocalData:function(){var e=this.$store.getters.userInfo.id,t=this.$store.state.user.currentSchool.id;s.a.remove(this.autoSaveLocalKey+e+t)}}}},"21fb":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("b0c0");var r={data:function(){return{unwatch:null,routeName:this.$route.name}},created:function(){var e=this;this.unwatch=this.$store.watch((function(e){return e.user.currentSchool}),(function(t){return t&&e.$route.name===e.routeName&&e.handleSchoolChange(t)}))},computed:{},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{handleSchoolChange:function(e){}}}},"419b":function(e,t,a){},"43e1":function(e,t,a){"use strict";a("a515")},4992:function(e,t,a){e.exports=a.p+"img/default-avatar.db1c5445.png"},"49de":function(e,t,a){"use strict";a.r(t),a.d(t,"materialAPIUrl",(function(){return o})),a.d(t,"MaterialAddOrUpdate",(function(){return n})),a.d(t,"MaterialQueryById",(function(){return s})),a.d(t,"MaterialDelete",(function(){return c})),a.d(t,"MaterialDeleteBatch",(function(){return i})),a.d(t,"MaterialList",(function(){return l})),a.d(t,"YoutubeQueryByKeywords",(function(){return d})),a.d(t,"FileRecord",(function(){return u})),a.d(t,"addFileUploadRecord",(function(){return f}));var r=a("b775"),o={MaterialAddOrUpdate:"/classcipe/api/material/addOrUpdate",MaterialQueryById:"/classcipe/api/material/queryById",MaterialDelete:"/classcipe/api/material/delete",MaterialDeleteBatch:"/classcipe/api/material/deleteBatch",MaterialList:"/classcipe/api/material/list",YoutubeQueryByKeywords:"/classcipe/api/youtube/queryByKeywords",FileRecord:"/classcipe/api/fileUploadRecord/list",addFileUploadRecord:"/classcipe/api/fileUploadRecord/add"};function n(e){return Object(r["d"])({url:o.MaterialAddOrUpdate,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(e){return Object(r["d"])({url:o.MaterialQueryById,method:"get",params:e})}function c(e){return Object(r["d"])({url:o.MaterialDelete,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function i(e){return Object(r["d"])({url:o.MaterialDeleteBatch,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(r["d"])({url:o.MaterialList,method:"get",params:e})}function d(e){return Object(r["d"])({url:o.YoutubeQueryByKeywords,method:"get",params:e})}function u(e){return Object(r["d"])({url:o.FileRecord,method:"get",params:e})}function f(e){return Object(r["d"])({url:o.addFileUploadRecord,method:"post",data:e})}},"577f":function(e,t,a){},6629:function(e,t,a){"use strict";a("419b")},"6d78":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("4de4"),a("07ac"),a("b64b");var r=a("8ded"),o=a.n(r),n={data:function(){return{validateFileds:{},refName:"form"}},computed:{hasErrors:function(){return Object.values(this.validateFileds).filter((function(e){return!e})).length>0}},methods:{initValidate:function(e){var t=this;!e&&this.validatorRules&&this.$refs[this.refName].validateField(Object.keys(this.validatorRules),(function(e){var a=t.$store.getters.userInfo.id,r=t.autoSaveLocalKey?o.a.get(t.autoSaveLocalKey+a):"";r||t.$refs[t.refName].clearValidate()}))},fillValidate:function(e,t){this.$set(this.validateFileds,e,t)}}}},"6e84":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("b0c0");var r={data:function(){return{unwatch:null,routeName:this.$route.name}},computed:{redirectUrl:function(){return"student"===this.$store.state.user.currentRole?"/student/main/my-task":"/account/info"}},created:function(){var e=this;this.unwatch=this.$store.watch((function(e){return e.app.userMode}),(function(t){t&&e.$route.name===e.routeName&&(e.handleModeChange(t),e.routeInMode())})),this.routeInMode()},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{routeInMode:function(){this.$route.meta.mode&&this.$route.meta.mode!==this.$store.state.app.userMode&&this.$router.push({path:this.redirectUrl})},handleModeChange:function(e){}}}},"6f2a":function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return f})),a.d(t,"h",(function(){return m}));a("d3b7");var r=a("b775"),o="api2/school/role",n={listRole:"/classcipe/".concat(o,"/list"),pageListRole:"/classcipe/".concat(o,"/pageList"),getRolePermission:"/classcipe/".concat(o,"/getPermission"),bindRoleSubjectLeader:"/classcipe/".concat(o,"/user/bindSubjectLeader"),bindRoleClassTeachers:"/classcipe/".concat(o,"/user/bindTeachers"),getRoleSubjectLeaders:"/classcipe/".concat(o,"/user/getSubjectLeaders"),getRoleClassTeachers:"/classcipe/".concat(o,"/user/getTeachers"),getSchoolRole:"/classcipe/".concat(o,"/user/getSchoolRole"),saveSchoolRole:"/classcipe/".concat(o,"/user/saveSchoolRole")};function s(e){return Object(r["d"])({url:n.getSchoolRole,method:"get",params:e}).then((function(e){var t=e;if(0===t.code){var a=[];for(var r in t.result.roleNames)"Teacher"!==r&&a.push({roleCode:r,name:t.result.roleNames[r]});t.result=a}return Promise.resolve(t)})).catch((function(e){return Promise.reject(e)}))}function c(e){return Object(r["d"])({url:n.getSchoolRole,method:"get",params:e}).then((function(e){var t=e;if(0===t.code){var a=[];for(var r in t.result.roleNames)"Teacher"!==r&&a.push({roleCode:r,name:t.result.roleNames[r]});t.result={total:a.length,records:a}}return Promise.resolve(t)})).catch((function(e){return Promise.reject(e)}))}function i(e){return Object(r["d"])({url:n.getRolePermission,method:"get",params:e})}function l(e){return Object(r["d"])({url:n.bindRoleSubjectLeader,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(r["d"])({url:n.bindRoleClassTeachers,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(r["d"])({url:n.getRoleSubjectLeaders,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(e){return Object(r["d"])({url:n.getRoleClassTeachers,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(e){return Object(r["d"])({url:n.saveSchoolRole,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},"8d90":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.$t("account.settings.avatar.edit"),visible:e.visible,maskClosable:!1,confirmLoading:e.confirmLoading,width:800,footer:null},on:{cancel:e.cancelHandel}},[a("a-row",[a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,autoCrop:e.options.autoCrop,autoCropWidth:e.options.autoCropWidth,autoCropHeight:e.options.autoCropHeight,fixedBox:e.options.fixedBox},on:{realTime:e.realTime}})],1),a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("div",{staticClass:"avatar-upload-preview"},[a("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),a("br"),a("a-row",[a("a-col",{attrs:{lg:2,md:2}},[a("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{icon:"upload"}},[e._v(e._s(e.$t("account.settings.avatar.select-image")))])],1)],1),a("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[a("a-button",{attrs:{icon:"plus"},on:{click:function(t){return e.changeScale(1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"minus"},on:{click:function(t){return e.changeScale(-1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"undo"},on:{click:e.rotateLeft}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"redo"},on:{click:e.rotateRight}})],1),a("a-col",{attrs:{lg:{span:2,offset:6},md:2}},[a("a-button",{attrs:{type:"primary",disabled:e.confirmLoading,loading:e.confirmLoading},on:{click:e.uploadImage}},[a("a-icon",{attrs:{type:"cloud-upload"}}),e._v(" Upload image ")],1)],1)],1)],1)},o=[],n=(a("ac1f"),a("1276"),a("466d"),a("ace4"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("99af"),a("fb6a"),a("25f0"),a("d0d0")),s={data:function(){return{visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{edit:function(e){this.visible=!0,this.id=e},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(e){var t=this,a=new FileReader;return a.readAsDataURL(e),a.onload=function(){t.options.img=a.result},!1},uploadImage:function(){var e=this;this.$refs.cropper.getCropData((function(t){var a=t.split(","),r=a[0].match(/:(.*?);/)[1],o=atob(a[1]),s=o.length,c=new Uint8Array(s);while(s--)c[s]=o.charCodeAt(s);e.model=!0,e.modelSrc=t;var i=r.split("/")[1],l=new File([c],"custom_image_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2),".").concat(i),{type:r});e.$logger.info("upload file",l),e.confirmLoading=!0,Object(n["a"])(e.$store.getters.userInfo.id,l,e.getProgressUpLoad,(function(t){e.onSuccess(l,t)}),!0)}))},getProgressUpLoad:function(e){this.$logger.info("getProgressUpLoad",e),this.confirmLoading=!0},onSuccess:function(e,t){this.$logger.info("upload success",e,t),this.$emit("ok",t),this.confirmLoading=!1,this.okHandel()},okHandel:function(){var e=this;e.confirmLoading=!0,setTimeout((function(){e.confirmLoading=!1,e.close(),e.$message.success("update avatar successfully!")}),2e3)},realTime:function(e){this.previews=e}}},c=s,i=(a("e437"),a("0c7c")),l=Object(i["a"])(c,r,o,!1,null,"1c917dd3",null);t["a"]=l.exports},a515:function(e,t,a){},e052:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-full-form-wrapper",attrs:{id:"formRoot"}},[r("fixed-form-header",{scopedSlots:e._u([{key:"header",fn:function(){return[r("form-header",{attrs:{title:e.title,"show-share":!1,"show-collaborate":!1,"is-preview-mode":!0},on:{back:e.goBack},scopedSlots:e._u([{key:"back",fn:function(){return[r("img",{staticClass:"single-logo-img",attrs:{src:a("be50"),alt:"classcipe"},on:{click:function(t){return t.stopPropagation(),e.$router.push("/")}}})]},proxy:!0},{key:"left",fn:function(){return[r("a-space",{attrs:{size:5,align:"center"},on:{click:function(e){e.stopPropagation()}}},[r("label",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$router.push("/account/info")}}},[e._v("Account Info")]),r("label",{attrs:{for:""}},[e._v(">")]),r("label",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$router.push("/manage/teacher")}}},[e._v("School Teacher")]),r("label",{attrs:{for:""}},[e._v(">")]),r("label",{staticStyle:{"font-weight":"normal"}},[e._v(e._s(e.title))])])]},proxy:!0},{key:"right",fn:function(){},proxy:!0}])})]},proxy:!0}])}),r("div",{staticClass:"form-content"},[r("school-teacher-add",{ref:"schoolTeacherAdd",attrs:{school:e.currentSchool,id:e.id},on:{save:e.handleSave}})],1)],1)},o=[],n=a("5530"),s=a("f93e"),c=a("6e84"),i=a("21fb"),l=a("b5ff8"),d=a("b5a9"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.teacherId?r("div",{staticClass:"account-info-self"},[r("div",{staticClass:"info-self-avatar"},[e.formModel.avatar?r("img",{attrs:{src:e.formModel.avatar}}):r("img",{attrs:{src:a("4992")}}),r("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$refs.avatarModal.edit(1)}}},[e._v("Upload")])],1)]):e._e(),r("a-form-model",e._b({ref:"form",attrs:{layout:"horizontal",model:e.formModel,rules:e.validatorRules},on:{validate:e.doValidate}},"a-form-model",e.formItemLayout,!1),[e.teacherId&&e.userMode===e.USER_MODE.SCHOOL?r("a-form-model-item",{attrs:{label:"Last Login",wrapperCol:{span:18}}},[r("a-row",{attrs:{gutter:0}},[r("a-col",{attrs:{span:16}},[e._v(" "+e._s(this.formModel.lastLogin?this.formModel.lastLogin|e.dayjs:" - ")+" ")]),r("a-col",{staticStyle:{"text-align":"center"},attrs:{span:2}}),e.teacherId&&e.formModel.inviteEmail?r("a-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[r("a-button",{attrs:{type:"black",disabled:e.origin.status===e.SCHOOL_USER_STATUS.ACTIVE.value,loading:e.confirmLoading},on:{click:e.handleReset}},[e._v("Reset Password")])],1):e._e()],1)],1):e._e(),e.teacherId&&e.userMode===e.USER_MODE.SELF?r("a-form-model-item",{attrs:{label:"",wrapperCol:{span:18}}},[r("a-row",{attrs:{gutter:0}},[r("a-col",{attrs:{span:16}}),r("a-col",{staticStyle:{"text-align":"center"},attrs:{span:2}}),e.teacherId&&e.formModel.inviteEmail?r("a-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[r("a-button",{attrs:{type:"black",disabled:e.origin.status===e.SCHOOL_USER_STATUS.ACTIVE.value,loading:e.confirmLoading},on:{click:e.handleReset}},[e._v("Reset Password")])],1):e._e()],1)],1):e._e(),r("a-form-model-item",{staticClass:"mb0",attrs:{label:"Name",required:!0}},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{prop:"firstName",hasFeedback:!0}},[r("a-input",{attrs:{placeholder:"First name"},model:{value:e.formModel.firstName,callback:function(t){e.$set(e.formModel,"firstName",t)},expression:"formModel.firstName"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{prop:"lastName",hasFeedback:!0}},[r("a-input",{attrs:{placeholder:"Last name"},model:{value:e.formModel.lastName,callback:function(t){e.$set(e.formModel,"lastName",t)},expression:"formModel.lastName"}})],1)],1)],1)],1),r("a-form-model-item",{attrs:{label:"Email",prop:"inviteEmail",hasFeedback:!0}},[r("a-input",{attrs:{disabled:e.teacherId&&!!e.formModel.inviteEmail,placeholder:"Email"},model:{value:e.formModel.inviteEmail,callback:function(t){e.$set(e.formModel,"inviteEmail",t)},expression:"formModel.inviteEmail"}})],1),r("a-form-model-item",{attrs:{label:"DOB"}},[r("a-date-picker",{attrs:{"disabled-date":e.disabledDate},model:{value:e.formModel.birthDay,callback:function(t){e.$set(e.formModel,"birthDay",t)},expression:"formModel.birthDay"}})],1),r("a-form-model-item",{staticClass:"mb0",attrs:{label:"Class"}},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:18}},[r("a-form-model-item",{staticClass:"self-select"},[r("a-select",{attrs:{mode:"multiple",optionFilterProp:"children",getPopupContainer:function(e){return e.parentElement},placeholder:"Please select class"},model:{value:e.formModel.classArr,callback:function(t){e.$set(e.formModel,"classArr",t)},expression:"formModel.classArr"}},e._l(e.classList,(function(t){return r("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1),r("div",{ref:"tagRender",staticClass:"tag-render",attrs:{size:4},on:{click:e.showSelect}},e._l(e.formModel.classArr,(function(t){return r("a-tag",{key:"tag"+t,attrs:{closable:e.isShowClose(t),color:e.clsColor(t)},on:{close:function(a){return e.closeCls(t)}}},[e._v(e._s(e.formatName(t,e.classList)))])})),1)],1)],1),e.showClassLink?r("a-col",{attrs:{span:6}},[r("a-button",{attrs:{type:"link"},on:{click:e.handelGoClass}},[e._v("Class Manage")])],1):e._e()],1)],1),e.teacherId?r("a-form-model-item",{attrs:{label:"Roles"}},[r("a-space",e._l(e.formModel.roleArr,(function(t){return r("a-tag",{key:"role_"+t},[e._v(e._s(t))])})),1)],1):e._e(),r("a-form-model-item",{attrs:{wrapperCol:{offset:6}}},[r("a-button",{attrs:{disabled:e.hasErrors,loading:e.loading,type:"primary"},on:{click:e.handleSave}},[e._v(e._s(e.teacherId?"Update":"Create"))])],1)],1),r("a-modal",{attrs:{destroyOnClose:"",title:"Reset Password",width:"600px",footer:null},model:{value:e.passwordVis,callback:function(t){e.passwordVis=t},expression:"passwordVis"}},[r("reset-password",{attrs:{needOld:!1}})],1),r("avatar-modal",{ref:"avatarModal",on:{ok:e.setAvatar}})],1)},f=[],m=a("3835"),h=(a("d3b7"),a("3ca3"),a("ddb0"),a("4de4"),a("d81d"),a("a15b"),a("b0c0"),a("fb6a"),a("a630"),a("6062"),a("ac1f"),a("1276"),a("7db0"),a("ad59")),p=a("ec09"),b=a("6f2a"),g=a("f371"),v=a("8d90"),w=a("6d78"),S=a("0fac"),y=a("c1df"),j=a.n(y),O=a("2f62"),M={name:"SchoolTeacherAdd",components:{ResetPassword:g["a"],AvatarModal:v["a"]},mixins:[w["a"],S["a"]],props:{school:{type:Object,default:function(){}},id:{type:String,default:null},showClassLink:{type:Boolean,default:!0}},watch:{school:{handler:function(e){this.currentSchool=Object(n["a"])({},e),this.initData()},deep:!0,immediate:!0},id:{handler:function(e){this.teacherId=e,this.initForm()},immediate:!0}},data:function(){var e;return{SCHOOL_USER_STATUS:s["A"],USER_MODE:s["X"],currentSchool:this.school,teacherId:this.id,classList:[],roleList:[],formModel:{firstName:"",lastName:"",birthDay:"",classes:"",classArr:[],inviteEmail:"",roles:"",roleArr:[],schoolId:(null===(e=this.school)||void 0===e?void 0:e.id)||"",avatar:""},origin:{},formItemLayout:{labelCol:{span:6},wrapperCol:{span:12}},loading:!1,passwordVis:!1,confirmLoading:!1,cacheKey:"SUBMIT_VALIDATE_SCHOOL_TEACHER_",autoSaveLocalKey:"FORM_SCHOOL_TEACHER_",needAutoSave:!this.id}},computed:Object(n["a"])(Object(n["a"])({},Object(O["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool},userMode:function(e){return e.app.userMode}})),{},{validatorRules:function(){return{firstName:[{required:!0,message:"Please Input First Name!"}],lastName:[{required:!0,message:"Please Input Last Name!"}],inviteEmail:[{required:!0,message:"Please Input Email!",trigger:"change"},{type:"email",message:"Please Input Valid Email!",trigger:"blur"},{validator:this.validateRemoteEmail,trigger:"blur"}],classArr:[{required:!0,message:"Please Select a class!",trigger:"change"}],roleArr:[{required:!0,message:"Please Select a role!",trigger:"change"}]}}}),methods:{initData:function(){var e=this;Promise.all([Object(h["h"])({schoolId:this.currentSchool.id,pageNo:1,pageSize:1e4}),Object(b["f"])({schoolId:this.currentSchool.id})]).then((function(t){var a=Object(m["a"])(t,2),r=a[0],o=a[1];0===r.code&&(e.classList=r.result.records.filter((function(e){return 2!==e.classType}))),0===o.code&&(e.roleList=o.result)}))},initForm:function(e){var t=this;if(this.teacherId)this.loading=!0,Object(p["p"])({schoolId:this.currentSchool.id,userId:this.teacherId}).then((function(e){if(0===e.code&&(t.origin=Object(n["a"])({},e.result),t.formModel.id=e.result.id,t.formModel.firstName=e.result.firstname,t.formModel.lastName=e.result.lastname,t.formModel.birthDay=e.result.birthday,t.formModel.avatar=e.result.avatar,t.formModel.inviteEmail=e.result.inviteEmail,e.result.classes&&(t.formModel.classArr=e.result.classes.map((function(e){return e.id})),t.formModel.classes=t.formModel.classArr.join(",")),e.result.roles)){var a=e.result.roles.filter((function(e){return"teacher"!==e.name.toLowerCase()})).map((function(e){return e.name.charAt(0).toLowerCase()+e.name.slice(1)}));t.formModel.roleArr=Array.from(new Set(a)).map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),t.formModel.roles=t.formModel.roleArr.join(",")}})).finally((function(){t.loading=!1}));else{var a=this.getAutoLocalData();this.formModel=Object(n["a"])(Object(n["a"])(Object(n["a"])({},this.formModel),a),e),this.formModel.classes&&(this.formModel.classArr=this.formModel.classes.split(","))}this.$nextTick((function(){t.initValidate(!!t.id)}))},doValidate:function(e,t){this.fillValidate(e,t)},validateRemoteEmail:function(e,t,a){return t?this.teacherId&&t===this.origin.inviteEmail?a():void Object(p["k"])({emails:t,schoolId:this.currentSchool.id}).then((function(e){0===e.code&&e.result&&e.result[0].exists?a(new Error("Teacher already exists")):a()})).catch((function(e){a(new Error(e.message))})):a()},setAvatar:function(e){this.formModel.avatar=e},disabledDate:function(e){return e&&e>j()()},handelGoClass:function(){this.$router.push("/manage/class")},handleReset:function(){var e=this;this.$confirm({title:"Confirm Reset Password",content:"Do you want to reset password?",centered:!0,onOk:function(){e.confirmLoading=!0,Object(p["u"])({userIds:[e.teacherId]}).then((function(t){0===t.code&&e.$message.success("Opt Successfully")})).finally((function(){e.confirmLoading=!1}))}})},handleSave:function(){var e=this;this.$refs.form.validate((function(t){if(t){var a=Object(n["a"])({},e.formModel);a.schoolId=e.currentSchool.id,a.classes=a.classArr.join(","),a.roles=a.roleArr.join(","),a.birthDay&&(a.birthday=a.birthDay=j.a.utc(a.birthDay).format("YYYY-MM-DD HH:mm:ss")),e.loading=!0;var r=p["d"];e.teacherId&&(r=p["z"]),r(a).then((function(t){0===t.code&&(e.$message.success("Save successfully"),e.clearLocalData(),e.$emit("save",a))})).finally((function(){e.loading=!1}))}}))},formatName:function(e,t){var a=t.find((function(t){return t.id===e}));return a?a.name:""},isShowClose:function(e){return!0},closeCls:function(e){this.formModel.classArr=this.formModel.classArr.filter((function(t){return t!==e}))},clsColor:function(e){return""},showSelect:function(e){this.$refs.tagRender.previousElementSibling.click()}}},T=M,C=(a("43e1"),a("0c7c")),L=Object(C["a"])(T,u,f,!1,null,"00d60676",null),P=L.exports,k=a("4fcf"),A=k.debounce,_={name:"SchoolTeacherEdit",mixins:[c["a"],i["a"]],components:{FixedFormHeader:l["a"],FormHeader:d["a"],SchoolTeacherAdd:P},props:{id:{type:String,default:null}},data:function(){return{USER_MODE:s["X"],SCHOOL_USER_STATUS:s["A"]}},created:function(){this.debounceLoad=A(this.loadData,300)},computed:Object(n["a"])(Object(n["a"])({},Object(O["e"])({userMode:function(e){return e.app.userMode},currentSchool:function(e){return e.user.currentSchool}})),{},{title:function(){return this.id?"Edit":"Add"}}),methods:{goBack:function(){this.$router.go(-1)},handleSchoolChange:function(e){this.userMode===s["X"].SCHOOL&&(this.queryParam.schoolId=e.id,this.initDict(),this.debounceInit())},handleModeChange:function(e){this.debounceInit()},loadData:function(){},handleSave:function(e){this.goBack()}}},I=_,U=(a("6629"),Object(C["a"])(I,r,o,!1,null,"9d89fbe6",null));t["default"]=U.exports},e437:function(e,t,a){"use strict";a("577f")},ec09:function(e,t,a){"use strict";a.d(t,"m",(function(){return c})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"s",(function(){return d})),a.d(t,"t",(function(){return u})),a.d(t,"l",(function(){return f})),a.d(t,"x",(function(){return m})),a.d(t,"z",(function(){return h})),a.d(t,"h",(function(){return p})),a.d(t,"g",(function(){return b})),a.d(t,"a",(function(){return g})),a.d(t,"e",(function(){return v})),a.d(t,"f",(function(){return w})),a.d(t,"n",(function(){return S})),a.d(t,"p",(function(){return y})),a.d(t,"i",(function(){return j})),a.d(t,"j",(function(){return O})),a.d(t,"k",(function(){return M})),a.d(t,"u",(function(){return T})),a.d(t,"q",(function(){return C})),a.d(t,"y",(function(){return L})),a.d(t,"w",(function(){return P})),a.d(t,"r",(function(){return k})),a.d(t,"v",(function(){return A})),a.d(t,"b",(function(){return _})),a.d(t,"o",(function(){return I}));var r=a("b775"),o=a("ca00"),n="api2/school/user",s={getSchoolUsers:"/classcipe/".concat(n,"/getSchoolUsers"),addStudents:"/classcipe/".concat(n,"/addStudents"),addTeacher:"/classcipe/".concat(n,"/addTeacher"),removeStudents:"/classcipe/".concat(n,"/removeStudents"),removeTeachers:"/classcipe/".concat(n,"/removeTeachers"),updateTeacher:"/classcipe/".concat(n,"/updateTeacher"),getInvite:"/classcipe/".concat(n,"/getInvite"),updateInvite:"/classcipe/".concat(n,"/updateInvite"),bulkActTeacher:"/classcipe/".concat(n,"/teacher/bulkAct"),bulkActStudent:"/classcipe/".concat(n,"/student/bulkAct"),acceptInvite:"/classcipe/".concat(n,"/acceptInvite"),batchAddStudent:"/classcipe/".concat(n,"/batchAddStudent"),batchAddTeacher:"/classcipe/".concat(n,"/batchAddTeacher"),getStudentInfo:"/classcipe/".concat(n,"/getStudentInfo"),getTeacherInfo:"/classcipe/".concat(n,"/getTeacherInfo"),checkEmailParent:"/classcipe/".concat(n,"/parent/checkEmail"),resetPassword:"/classcipe/".concat(n,"/resetPassword"),checkEmailStudent:"/classcipe/".concat(n,"/student/checkEmail"),moveClassStudent:"/classcipe/".concat(n,"/student/moveClass"),sendParentEmail:"/classcipe/".concat(n,"/student/sendParentEmail"),checkEmailTeacher:"/classcipe/".concat(n,"/teacher/checkEmail"),updateStudent:"/classcipe/".concat(n,"/updateStudent"),addAdmin:"/classcipe/".concat(n,"/addAdmin"),removeAdmins:"/classcipe/".concat(n,"/removeAdmins"),resetUserPassword:"/classcipe/".concat(n,"/user/resetPassword"),addSchoolAdmin:"/classcipe/".concat(n,"/addSchoolAdmin"),getTeacherCount:"/classcipe/".concat(n,"/getTeacherCount")};function c(e){return Object(r["d"])({url:s.getSchoolUsers,method:"get",params:e})}function i(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.addStudents,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.addTeacher,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(r["d"])({url:s.removeStudents,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(r["d"])({url:s.removeTeachers,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(e){return Object(r["d"])({url:s.getInvite,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.updateInvite,method:"post",data:e,params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.updateTeacher,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(e){return Object(r["d"])({url:s.bulkActTeacher,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function b(e){return Object(r["d"])({url:s.bulkActStudent,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function g(e){return Object(r["d"])({url:s.acceptInvite,method:"post",data:e,params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function v(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.batchAddStudent,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function w(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.batchAddTeacher,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function S(e){return Object(r["d"])({url:s.getStudentInfo,method:"get",params:e})}function y(e){return Object(r["d"])({url:s.getTeacherInfo,method:"get",params:e})}function j(e){return Object(r["d"])({url:s.checkEmailParent,method:"get",params:e})}function O(e){return Object(r["d"])({url:s.checkEmailStudent,method:"get",params:e})}function M(e){return Object(r["d"])({url:s.checkEmailTeacher,method:"get",params:e})}function T(e){return Object(r["d"])({url:s.resetPassword,method:"get",params:e})}function C(e){return Object(r["d"])({url:s.moveClassStudent,method:"get",params:e})}function L(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.updateStudent,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function P(e){return Object(r["d"])({url:s.sendParentEmail,method:"get",params:e})}function k(e){return Object(r["d"])({url:s.removeAdmins,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function A(e){return Object(r["d"])({url:s.resetUserPassword,method:"get",params:e})}function _(e){return e=Object(o["trimParams"])(e),Object(r["d"])({url:s.addSchoolAdmin,method:"post",data:e,params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function I(e){return Object(r["d"])({url:s.getTeacherCount,method:"get",params:e})}},f371:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-form-model",e._b({ref:"form",attrs:{layout:"horizontal",model:e.formModel,rules:e.validatorRules}},"a-form-model",e.formItemLayout,!1),[e.needOld?a("a-form-model-item",{attrs:{label:"Old Password",prop:"password"}},[a("a-input-password",{attrs:{autocomplete:"off",required:!0,type:"password",placeholder:"input password"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1):e._e(),a("a-form-model-item",{attrs:{label:"New Password",prop:"newPassword"}},[a("a-input-password",{attrs:{autocomplete:"off",type:"password",placeholder:"input password"},model:{value:e.formModel.newPassword,callback:function(t){e.$set(e.formModel,"newPassword",t)},expression:"formModel.newPassword"}})],1),a("a-form-model-item",{attrs:{label:"Confirm Password",prop:"confirmPassword"}},[a("a-input-password",{attrs:{autocomplete:"off",type:"password",placeholder:"input password"},model:{value:e.formModel.confirmPassword,callback:function(t){e.$set(e.formModel,"confirmPassword",t)},expression:"formModel.confirmPassword"}})],1),a("a-form-model-item",{attrs:{wrapperCol:{offset:6,span:12},label:""}},[a("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleSave}},[e._v("update")])],1)],1)},o=[],n=(a("d3b7"),a("7ded")),s={name:"ResetPassword",props:{needOld:{type:Boolean,default:!0},saveFn:{type:Function,default:null}},data:function(){var e=this,t=/^(?=.*[a-zA-Z])(?=.*[0-9])[^]{8,}$/,a=function(e,t,a){if(!t)return a(new Error("Please input the password"));Object(n["b"])({password:t}).then((function(e){"Success"!==e.result?a(new Error("Incorrect password")):a()}))},r=function(a,r,o){""===r?o(new Error("Please input the password")):t.test(r)?(""!==e.formModel.confirmPassword&&e.$refs.form.validateField("confirmPassword"),o()):o(new Error("The password must be a combination of letters and numbers, and it must be 8 characters or more."))},o=function(t,a,r){""===a?r(new Error("Please input the password again")):a!==e.formModel.newPassword?r(new Error("Passwords did not match!")):r()};return{formModel:{password:"",newPassword:"",confirmPassword:""},formItemLayout:{labelCol:{span:6},wrapperCol:{span:18}},validatorRules:{password:[{required:!0,trigger:"change",message:"Please input the password"},{validator:a,trigger:"blur"}],newPassword:[{validator:r,trigger:"change"}],confirmPassword:[{validator:o,trigger:"change"}]},loading:!1}},methods:{handleSave:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.loading=!0,e.saveFn?e.saveFn({newPassword:e.formModel.newPassword,oldPassword:e.formModel.password}).then((function(t){0===t.code&&e.$message.success("Update password successfully")})).finally((function(){e.loading=!1})):Object(n["a"])({newPassword:e.formModel.newPassword,oldPassword:e.formModel.password}).then((function(t){0===t.code&&e.$message.success("Update password successfully")})).finally((function(){e.loading=!1})))}))}}},c=s,i=a("0c7c"),l=Object(i["a"])(c,r,o,!1,null,"f6bcd576",null);t["a"]=l.exports}}]);