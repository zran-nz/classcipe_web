(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59c4d6ce"],{"0bb4":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"d",(function(){return c})),s.d(t,"b",(function(){return o}));var n=s("b775"),a={listCementByUser:"/classcipe/sys/annountCement/listByUser",editCementSend:"/classcipe/sys/sysAnnouncementSend/editByAnntIdAndUserId",NoticeQueryById:"/classcipe/sys/annountCement/queryById",listByMessage:"/classcipe/sys/annountCement/listByMessage"};function i(e){return Object(n["d"])({url:a.editCementSend,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(n["d"])({url:a.listCementByUser,method:"get",params:e})}function c(e){return Object(n["d"])({url:a.NoticeQueryById,method:"get",params:e})}function o(e){return Object(n["d"])({url:a.listByMessage,method:"get",params:e})}},1778:function(e,t,s){"use strict";s.d(t,"d",(function(){return i})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return c})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return l})),s.d(t,"a",(function(){return u}));s("ac1f");var n=s("b775"),a={search:"/classcipe/api/v2/library/search",getLibraryRecommend:"/classcipe/api/v2/library/getLibraryRecommend",getLibraryResource:"/classcipe/api/v2/library/getLibraryResource",queryAllResource:"/classcipe/api/v2/library/queryAllResource",queryLibraryResource:"/classcipe/api/v2/library/queryLibraryResource",getLibraryPDContent:"/classcipe/api/v2/library/getLibraryPDContent"};function i(e){return Object(n["d"])({url:a.search,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(n["d"])({url:a.getLibraryRecommend,method:"get",params:e})}function c(e){return Object(n["d"])({url:a.getLibraryResource,method:"get",params:e})}function o(e){return Object(n["d"])({url:a.queryAllResource,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(n["d"])({url:a.queryLibraryResource,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(n["d"])({url:a.getLibraryPDContent,method:"get",params:e})}},3881:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-profile-avatar"},[n("div",{staticClass:"notification",on:{click:e.handleToNotification}},[n("a-badge",{attrs:{count:e.msgUnreadCount}},[n("a-icon",{style:{fontSize:"20px",color:"#999"},attrs:{type:"mail"}})],1)],1),n("a-dropdown",{attrs:{getPopupContainer:function(e){return e.parentElement}},model:{value:e.dropVis,callback:function(t){e.dropVis=t},expression:"dropVis"}},[e.currentAvatar?n("a-avatar",{attrs:{src:e.currentAvatar}}):n("img",{attrs:{src:s("4992")}}),n("div",{staticClass:"profile-info",attrs:{slot:"overlay"},slot:"overlay"},[n("div",{staticClass:"base-info"},[n("div",{staticClass:"avatar"},[e.currentAvatar?n("a-avatar",{attrs:{src:e.currentAvatar}}):n("img",{attrs:{src:s("4992")}})],1),n("div",{staticClass:"base"},[n("div",{staticClass:"name"},[e._v(e._s(e.currentRealName))]),n("div",{staticClass:"email"},[e._v(e._s(e.$store.getters.userInfo.email))])])]),n("div",{staticClass:"storage-info"},[n("a-progress",{staticClass:"cc-storage-progress",attrs:{percent:e.storageProgress,"show-info":!1}}),n("div",{staticClass:"storage-info-text"},[e._v(" "+e._s(e._f("sizeFormat")(e.consumedSize))+" of "+e._s(e._f("sizeFormat")(e.totalSize))+" ")])],1),n("div",{staticClass:"plan-upgrade"},[n("a-space",[e.info.planInfo&&!e.info.planInfo.freeUsePlan?n("div",{staticClass:"free-plan"},[e._v(e._s(e.info.planInfo.planName))]):n("div",{staticClass:"free-plan"},[e._v("Free plan")]),n("div",{staticClass:"upgrade"},[e._v("Upgrade")])]),e.info.planInfo&&e.info.planInfo.planUser&&e.info.planInfo.planUser.planEndTime&&!e.info.planInfo.freeUsePlan?n("div",{staticClass:"plan-end"},[e._v(" Ends on "+e._s(e.info.planInfo.planUser.planEndTime)+" ")]):e._e()],1),n("a-divider",{staticClass:"cc-small-divider"}),n("div",{staticClass:"class-info"},[n("div",{staticClass:"class-list"},[n("div",{class:{"class-item":!0,active:e.userMode===e.USER_MODE.SELF},on:{click:e.handleChangePersonal}},[n("div",{staticClass:"class-avatar"},[e.$store.getters.userInfo.avatar?n("a-avatar",{attrs:{src:e.$store.getters.userInfo.avatar}}):n("img",{attrs:{src:s("4992")}})],1),n("div",{staticClass:"class-base-info"},[n("div",{staticClass:"class-name"},[e._v("Personal")]),n("div",{staticClass:"class-updated-by"},[e._v(e._s(e.$store.getters.userInfo.firstname)+" "+e._s(e.$store.getters.userInfo.lastname))])])]),e._l(e.info.schoolList,(function(t){return n("div",{key:t.id,class:{"class-item":!0,active:e.userMode===e.USER_MODE.SCHOOL&&e.currentSchool.id===t.id},on:{click:function(s){return e.handleChangeSchool(t)}}},[n("div",{staticClass:"class-avatar"},[t.schoolUser.avatar?n("a-avatar",{attrs:{src:t.schoolUser.avatar}}):n("a-avatar",{staticStyle:{color:"#f56a00",backgroundColor:"#fde3cf"}},[e._v(" "+e._s(t.schoolName?t.schoolName[0].toUpperCase():"C")+" ")])],1),n("div",{staticClass:"class-base-info"},[n("div",{staticClass:"class-name"},[e._v(e._s(t.schoolName))]),n("div",{staticClass:"class-updated-by"},[t.schoolUser.firstname||t.schoolUser.lastname?[e._v(" "+e._s(t.schoolUser.firstname)+" "+e._s(t.schoolUser.lastname)+" ")]:[e._v(" "+e._s(e.$store.getters.userInfo.firstname)+" "+e._s(e.$store.getters.userInfo.lastname)+" ")]],2)])])}))],2)]),n("a-divider",{staticClass:"cc-small-divider"}),e.isAuth?n("div",{staticClass:"account profile-menu-item",on:{click:e.handleToAccounts}},[e.userMode===e.USER_MODE.SCHOOL?[e._v(" School account ")]:[e._v(" Account ")]],2):e._e(),n("div",{staticClass:"logout profile-menu-item",on:{click:e.handleLogout}},[e._v(" Logout ")])],1)],1)],1)},a=[],i=s("1da1"),r=(s("cd17"),s("ed3b")),c=s("5530"),o=(s("d3b7"),s("ac1f"),s("5319"),s("caad"),s("2532"),s("99af"),s("d81d"),s("96cf"),s("2f62")),l=s("c24f"),u=s("9fb0"),d=s("f93e"),h=s("6757"),p=s("0bb4"),f=s("8ee6"),m={name:"UserProfileAvatar",data:function(){return{unit:1073741824,schoolUserRole:h["a"],USER_MODE:d["U"],msg1Count:"0",msg2Count:"0",stopTimer:!1,dropVis:!1}},computed:Object(c["a"])(Object(c["a"])({},Object(o["e"])({info:function(e){return e.user.info},currentSchool:function(e){return e.user.currentSchool},userMode:function(e){return e.app.userMode},msgUnreadCount:function(e){return e.websocket.msgUnreadCount}})),{},{msgTotal:function(){return parseInt(this.msg1Count)+parseInt(this.msg2Count)},consumedSize:function(){return this.userMode===d["U"].SELF?1024*this.info.usedSpace:1024*this.currentSchool.usedSpace},totalSize:function(){return this.info.planInfo?this.info.planInfo.storageSpace*this.unit:this.unit},storageProgress:function(){return Math.round(this.consumedSize/this.totalSize*100)},isAuth:function(){return!0},currentAvatar:function(){return this.userMode===d["U"].SELF?this.info.avatar:this.currentSchool&&this.currentSchool.schoolUser&&this.currentSchool.schoolUser.avatar?this.currentSchool.schoolUser.avatar:this.info.avatar},currentRealName:function(){return this.userMode===d["U"].SELF?this.info.firstname+" "+this.info.lastname:this.currentSchool&&this.currentSchool.schoolUser&&(this.currentSchool.schoolUser.firstname||this.currentSchool.schoolUser.lastname)?this.currentSchool.schoolUser.firstname+" "+this.currentSchool.schoolUser.lastname:this.info.firstname+" "+this.info.lastname}}),created:function(){this.initData(),this.hasSetCurriculum()},methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(o["d"])([u["M"],"SET_CURRENT_SCHOOL"])),Object(o["b"])(["GetClassList"])),{},{timerFun:function(){var e=this;this.stopTimer=!1;var t=setInterval((function(){e.stopTimer?clearInterval(t):e.loadData()}),6e3)},initData:function(){var e=this;Object(p["c"])().then((function(t){t.success&&(e.announcement1=t.result.anntMsgList,e.msg1Count=t.result.anntMsgTotal,e.$store.commit("SET_UNREAD_COUNT",e.msg1Count?e.msg1Count:0),e.$store.commit("SET_SHARED_COUNT",t.result.collaborate?t.result.collaborate:0))})).catch((function(t){e.$logger.error("系统消息通知异常",t),e.stopTimer=!0,e.$logger.error("清理timer")}))},handleToSettings:function(){this.$router.push({path:"/account/settings"})},handleToAccounts:function(){this.$router.push({path:"/account/info"})},handleToNotification:function(){this.$router.push({path:"/notification"})},handleLogout:function(e){var t=this;r["a"].confirm({title:this.$t("layouts.usermenu.dialog.title"),content:this.$t("layouts.usermenu.dialog.content"),onOk:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("Logout");case 2:return e.next=4,AppLogout("www",null);case 4:location.href="/v2/login";case 5:case"end":return e.stop()}}),e)})));function s(){return e.apply(this,arguments)}return s}(),onCancel:function(){}})},handleChangePersonal:function(){var e=this;Object(l["c"])({isPersonal:!0,schoolId:""}).finally((function(){e[u["M"]](d["U"].SELF),e.GetClassList(),e.$router.replace("/teacher/main/created-by-me"),e.$store.dispatch("GetInfo").then((function(t){e.hasSetCurriculum()}))}))},handleChangeSchool:function(e){var t=this,s=this.userMode;Object(l["c"])({isPersonal:!1,schoolId:e.id}).then((function(n){t[u["M"]](d["U"].SCHOOL),t.GetClassList(e.id),s===d["U"].SELF&&t.$router.replace("/teacher/main/created-by-me"),t.$store.dispatch("GetInfo").then((function(e){t.hasSetCurriculum()}))}))},hasSetCurriculum:function(){var e=this;Object(f["a"])({schoolId:this.currentSchool.id}).then((function(t){0===t.code&&(t.result&&t.result.length>0?0===t.result[0].gradeSettingInfo.length&&e.doConfirmGoCuriculum():e.doConfirmGoCuriculum())}))},doConfirmGoCuriculum:function(){var e=this;if(this.userMode===d["U"].SCHOOL){var t=this.currentSchool.roleNames.includes("Admin");if(!t)return}var s="CURICULUM_SET_".concat(this.userMode,"_").concat(this.currentSchool.id,"_").concat(this.info.id),n=sessionStorage.getItem(s);n||this.$confirm({title:"Curriculum Set",content:"Please Set Curriculum first",centered:!0,onOk:function(){sessionStorage.setItem(s,1),e.$router.push("/manage/curriculum")},onCancel:function(){}})},hasRolePermission:function(e){var t=!1;if(this.userMode===d["U"].SCHOOL&&this.currentSchool.roleNames){var s=this.currentSchool.roleNames.map((function(e){return e.toLowerCase()}));t=s.includes(e)}return t}})},v=m,g=(s("d30e"),s("0c7c")),y=Object(g["a"])(v,n,a,!1,null,"321b92bf",null);t["a"]=y.exports},4992:function(e,t,s){e.exports=s.p+"img/default-avatar.db1c5445.png"},9774:function(e,t,s){"use strict";s("a730")},"980a":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"b",(function(){return c}));var n=s("b775"),a={PDContentAddOrUpdate:"/classcipe/api/v2/pd/addOrUpdate",PDContentQueryById:"/classcipe/api/v2/pd/queryById",PDContentDelete:"/classcipe/api/v2/pd/delete",PDContentDeleteBatch:"/classcipe/api/v2/pd/deleteBatch",PDContentList:"/classcipe/api/v2/pd/list"};function i(e){return Object(n["d"])({url:a.PDContentAddOrUpdate,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(n["d"])({url:a.PDContentQueryById,method:"get",params:e})}function c(e){return Object(n["d"])({url:a.PDContentDelete+"?id="+e.id,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},a730:function(e,t,s){},b199:function(e,t,s){"use strict";s.r(t),s.d(t,"taskAPIUrl",(function(){return a})),s.d(t,"TaskCreateTaskPPT",(function(){return i})),s.d(t,"TaskCreateNewTaskPPT",(function(){return r})),s.d(t,"TaskAddOrUpdate",(function(){return c})),s.d(t,"SplitTask",(function(){return o})),s.d(t,"TaskQueryById",(function(){return l})),s.d(t,"TaskDelete",(function(){return u})),s.d(t,"getTaskBySessionId",(function(){return d})),s.d(t,"UpdateSlideEditing",(function(){return h})),s.d(t,"QuerySubTask",(function(){return p}));var n=s("b775"),a={createTaskPPT:"/classcipe/api/task/createTaskPPT",createNewTaskPPT:"/classcipe/api/task/createNewTaskPPT",addOrUpdate:"/classcipe/api/task/addOrUpdate",delete:"/classcipe/api/task/delete",deleteBatch:"/classcipe/api/task/deleteBatch",list:"/classcipe/api/task/list",queryById:"/classcipe/api/task/queryById",splitTask:"/classcipe/api/task/spliteTask",getTaskBySessonId:"/classcipe/api/task/getTaskBySessonId",updateSlideEditing:"/classcipe/api/task/updateSlideEditing",querySubTask:"/classcipe/api/task/querySubTask"};function i(e){return Object(n["d"])({url:a.createTaskPPT,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(n["d"])({url:a.createNewTaskPPT,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(e){return Object(n["d"])({url:a.addOrUpdate,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(n["d"])({url:a.splitTask,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(n["d"])({url:a.queryById,method:"get",params:e})}function u(e){return Object(n["d"])({url:a.delete+"?id="+e.id,method:"post",data:e})}function d(e){return Object(n["d"])({url:a.getTaskBySessonId,method:"get",params:e})}function h(e){return Object(n["d"])({url:a.updateSlideEditing,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(e){return Object(n["d"])({url:a.querySubTask,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},c44c:function(e,t,s){var n=s("b2b7");e.exports={__esModule:!0,default:n.svgComponent({tag:"svg",attrsMap:{t:"1651919287086",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3862","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"48",height:"48"},children:[{tag:"defs"},{tag:"path",attrsMap:{d:"M1011.699621 955.59682l-299.842879-300.13541a400.32681 400.32681 0 1 0-56.555731 56.75075l299.84288 300.086654a39.686521 39.686521 0 0 0 28.277865 11.701186 41.636719 41.636719 0 0 0 28.765415-11.701186 39.784031 39.784031 0 0 0-0.48755-56.701994zM80.480272 401.594439a320.807504 320.807504 0 1 1 320.807503 321.148788 321.295053 321.295053 0 0 1-320.807503-321.343808z","p-id":"3863"}}]})}},c621:function(e,t,s){"use strict";s.d(t,"e",(function(){return i})),s.d(t,"a",(function(){return r})),s.d(t,"f",(function(){return c})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"d",(function(){return u}));var n=s("b775"),a={getTemplates:"/classcipe/api/templates/getTemplates",filterTemplates:"/classcipe/api/templates/filterTemplates",recommendTemplates:"/classcipe/api/templates/recommendTemplates",getPresentation:"/classcipe/api/templates/getPresentation",getPublishedPresentation:"/classcipe/api/templates/getPublishedPresentation",getPageThumbnail:"/classcipe/api/templates/getPageThumbnail",queryById:"/classcipe/api/templates/queryById"};function i(e){return Object(n["d"])({url:a.getTemplates,method:"get",params:e})}function r(e){return Object(n["d"])({url:a.filterTemplates,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(e){return Object(n["d"])({url:a.recommendTemplates,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(n["d"])({url:a.getPresentation,method:"get",params:e})}function l(e){return Object(n["d"])({url:a.getPageThumbnail,method:"get",params:e})}function u(e){return Object(n["d"])({url:a.getPublishedPresentation,method:"get",params:e})}},cd3e:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"global-search-input"},[s("div",{staticClass:"search-icon"},[s("a-icon",{attrs:{type:"search"},nativeOn:{click:function(t){return e.activeSearchInput.apply(null,arguments)}}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearchWrapper,expression:"showSearchWrapper"}],staticClass:"global-search"},[s("div",{staticClass:"search-input-line"},[s("div",{staticClass:"search-back"},[s("a-icon",{style:{color:"#999",fontSize:"16px"},attrs:{type:"arrow-left"},on:{click:e.handleBack}})],1),s("div",{staticClass:"search-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKeyword,expression:"searchKeyword"}],attrs:{autocomplete:"off",id:"search-input",placeholder:"Search..."},domProps:{value:e.searchKeyword},on:{keyup:[e.handleSearch,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.emitSearchEvent(e.searchKeyword)}],input:function(t){t.target.composing||(e.searchKeyword=t.target.value)}}})]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.searchKeyword.length>0,expression:"searchKeyword.length > 0"}],staticClass:"search-clear",on:{click:e.handleSearchClear}},[s("a-icon",{attrs:{type:"close"}})],1)]),s("div",{staticClass:"search-recommend-list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.searchKeyword,expression:"searchKeyword"}],staticClass:"do-search",on:{click:function(t){return e.emitSearchEvent(e.searchKeyword)}}},[s("div",{staticClass:"icon"},[s("a-icon",{style:{color:"#999",fontSize:"16px"},attrs:{type:"search"}})],1),s("div",{staticClass:"search-content-left"},[e._v(' Search "'),s("span",{staticClass:"bold"},[e._v(e._s(e.searchKeyword))]),e._v('" ')])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearchHistory,expression:"showSearchHistory"}],staticClass:"search-history"},e._l(e.historyList,(function(t){return s("div",{key:t,staticClass:"list-item",on:{click:function(s){return e.emitSearchEvent(t)}}},[s("div",{staticClass:"icon"},[s("a-icon",{style:{color:"#999",fontSize:"16px"},attrs:{type:"clock-circle",theme:"filled"}})],1),s("div",{staticClass:"search-content"},[e._v(" "+e._s(t)+" ")])])})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearchRecommend,expression:"showSearchRecommend"}],staticClass:"recommend-list"},[e._l(e.similarList,(function(t,n){return s("div",{key:n,staticClass:"list-item",on:{click:function(s){return e.emitSearchEvent(t.name)}}},[s("div",{staticClass:"icon similar-icon"},[e._v(" # ")]),s("div",{staticClass:"search-content"},[s("div",{staticClass:"content-name"},[e._v(" "+e._s(t.name)+" ")])])])})),e._l(e.pdList,(function(t){return s("div",{key:t.id,staticClass:"list-item",on:{click:function(s){return e.viewItem(t)}}},[e._m(0,!0),s("div",{staticClass:"search-content"},[s("div",{staticClass:"content-name"},[e._v(" "+e._s(t.name)+" ")])])])})),e._l(e.planList,(function(t){return s("div",{key:t.id,staticClass:"list-item",on:{click:function(s){return e.viewItem(t)}}},[e._m(1,!0),s("div",{staticClass:"search-content"},[s("div",{staticClass:"content-name"},[e._v(" "+e._s(t.name)+" ")])])])})),e._l(e.taskList,(function(t){return s("div",{key:t.id,staticClass:"list-item",on:{click:function(s){return e.viewItem(t)}}},[e._m(2,!0),s("div",{staticClass:"search-content"},[s("div",{staticClass:"content-name"},[e._v(" "+e._s(t.name)+" ")])])])}))],2),e.searching?s("div",{staticClass:"searching"},[s("a-spin",[s("a-icon",{staticStyle:{"font-size":"24px"},attrs:{slot:"indicator",type:"loading",spin:"",tip:"searching..."},slot:"indicator"})],1)],1):e._e()]),s("div",{staticClass:"bg-mask",on:{click:e.handleBack}})]),e.previewVisible?s("content-preview",{attrs:{"content-id":e.previewCurrentId,"content-type":e.previewType},on:{close:e.handlePreviewClose}}):e._e()],1)},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon"},[s("div",{staticClass:"tag-icon"},[e._v("PD")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon"},[s("div",{staticClass:"tag-icon"},[e._v("Unit")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon"},[s("div",{staticClass:"tag-icon"},[e._v("Task")])])}],i=s("5530"),r=(s("498a"),s("a434"),s("fb6a"),s("ac1f"),s("841c"),s("d3b7"),s("159b"),s("b0c0"),s("99af"),s("c44c")),c=s.n(r),o=s("85b1"),l=s("1778"),u=s("ce85"),d=s("f031"),h={name:"GlobalSearchInput",components:{ContentPreview:u["a"],SearchIcon:c.a},mixins:[d["a"]],data:function(){return{data:null,searchKeyword:"",showSearchWrapper:!1,searching:!1,handleSearch:null,pdList:[],planList:[],similarList:[],taskList:[],historyList:[]}},props:{schoolId:{type:String,default:"0"},source:{type:String,default:"library"}},computed:{showSearchHistory:function(){return null===this.searchKeyword||""===this.searchKeyword.trim()},showSearchRecommend:function(){return this.searchKeyword}},created:function(){this.handleSearch=Object(o["a"])(this.doSearch,300),this.restoreSearchKey()},methods:{storeSearchKey:function(){var e=this.$store.getters.userInfo.id;window.sessionStorage.setItem("".concat(e,"_search_key_list"),JSON.stringify(this.historyList))},restoreSearchKey:function(){var e=this.$store.getters.userInfo.id,t=window.sessionStorage.getItem("".concat(e,"_search_key_list"));this.historyList=t?JSON.parse(t):[]},handleSearchClear:function(){this.searchKeyword="",this.recommendList=[]},handleBack:function(){this.$logger.info("handleBack"),this.showSearchWrapper=!1},doSearch:function(){var e=this.searchKeyword.trim();if(e){var t=this.historyList.indexOf(e);-1!==t&&this.historyList.splice(t,1),this.historyList.unshift(e),this.historyList.length>5&&(this.historyList=this.historyList.slice(0,5)),this.storeSearchKey(),this.search(e)}},search:function(e){var t=this;this.$logger.info("search",e),this.searching=!0,this.recommendList=[],this.pdList=[],this.planList=[],this.taskList=[],this.similarList=[],Object(l["d"])({key:e,schoolId:this.schoolId}).then((function(s){t.$logger.info("searchByKeyword "+e,s);var n=[],a=s.result.similarList;t.pdList=s.result.pdList,t.planList=s.result.planList,t.taskList=s.result.taskList,a.forEach((function(t){if(t.name&&!n.some((function(e){return e.name===t.name}))){var s=0,a=t.name.toLowerCase().indexOf(e),i="";while(-1!==a&&a+e.length<=t.name.length)i+=t.name.substring(s,a)+'<span class="search-keyword-item">'+t.name.substring(a,a+e.length)+"</span>",s=a+e.length,a=t.name.toLowerCase().indexOf(e,a+e.length);i+=t.name.substring(s);var r={fromType:t.fromType,name:t.name,tagName:i,id:t.id};n.push(r)}})),t.similarList=a})).finally((function(){t.searching=!1}))},activeSearchInput:function(){this.showSearchWrapper=!0,this.$nextTick((function(){document.getElementById("search-input").focus()}))},emitSearchEvent:function(e){this.$logger.info("emitSearchEvent",e),this.$emit("search",e),this.handleBack()},viewItem:function(e){this.$logger.info("viewItem",e);var t=Object(i["a"])(Object(i["a"])({},e),{},{type:parseInt(e.fromType)});this.$logger.info("dataItem",e),this.showSearchWrapper=!1,this.$router.push({path:"/teacher/".concat(this.source,"-view/").concat(t.type,"/").concat(t.id)})}}},p=h,f=(s("9774"),s("0c7c")),m=Object(f["a"])(p,n,a,!1,null,"d3f54b0c",null);t["a"]=m.exports},ce85:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-drawer",{staticClass:"cc-content-preview-drawer",attrs:{visible:!0,closable:!1,title:null,width:"1000px",bodyStyle:{height:"100%"}},on:{close:e.handleClose}},[s("div",{staticClass:"content-preview"},[s("content-preview-detail",e._b({on:{close:e.handleClose,reload:e.handleReload}},"content-preview-detail",e.$attrs,!1))],1)])},a=[],i=(s("d3b7"),s("3ca3"),s("ddb0"),{name:"ContentPreview",components:{ContentPreviewDetail:function(){return Promise.all([s.e("chunk-6e709c5e"),s.e("chunk-14f6b998"),s.e("chunk-26488622"),s.e("chunk-8537801c"),s.e("chunk-e0b03e96")]).then(s.bind(null,"70fe"))}},data:function(){return{}},methods:{handleClose:function(){this.$emit("close")},handleReload:function(){this.$emit("reload")}}}),r=i,c=(s("fe45"),s("0c7c")),o=Object(c["a"])(r,n,a,!1,null,"499cb44e",null);t["a"]=o.exports},d30e:function(e,t,s){"use strict";s("fae4")},d340:function(e,t,s){},f031:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("1da1"),a=(s("d81d"),s("0481"),s("b0c0"),s("159b"),s("96cf"),s("c621")),i=s("f93e"),r=s("b199"),c=s("980a"),o=s("944d"),l={data:function(){return{allowPreview:!0,previewCurrentId:null,previewType:null,previewCode:null,previewVisible:!1,previewSchoolId:"0",updateEditSlideLoading:!1,setColor:["#FFEDAF","#C8F4FF","#E6E4FF","#ffccb0","#ffa9a2","#a3ecb9","#f7c5f8","#ffbfe2","#d5b9ff","#c4f6b1"],savingSlides:!1,formSteps:[],requiredFields:[],emptyRequiredFields:[]}},created:function(){return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},computed:{commandTermsList:function(){return Object(o["a"])(this.content.learnOuts.map((function(e){return e.commandTerms})).flat(2),"name").map((function(e){return e.name}))},knowledgeTagsList:function(){return Object(o["a"])(this.content.learnOuts.map((function(e){return e.knowledgeTags})).flat(2),"name").map((function(e){return e.name}))}},methods:{handlePreviewDetail:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$logger.info("handlePreviewDetail",e,"allowPreview",this.allowPreview),this.allowPreview&&(this.previewVisible=!1,this.$nextTick((function(){t.previewCurrentId=s&&e.sourceFrom||e.id,t.previewType=e.type,t.previewCode=e.sessionId||e.sessionInfo&&e.sessionInfo.classId,t.previewSchoolId=e.schoolId?e.schoolId:"0",t.reviewList=!1,t.reviewCreate=!!s,t.reviewEdit=!!s,t.previewVisible=!0})),this.$emit("preview",e))},handlePreviewDeleteDetail:function(e){var t=this;this.$logger.info("handlePreviewDeleteDetail",e,"allowPreview",this.allowPreview),this.allowPreview&&(this.previewVisible=!1,this.$nextTick((function(){t.previewCurrentId=e.contentId,t.previewType=e.contentType,t.previewCode=e.classId,t.reviewList=!1,t.reviewCreate=!1,t.reviewEdit=!1,t.previewVisible=!0})),this.$emit("preview",e))},handlePreviewClose:function(){this.$logger.info("handlePreviewClose"),this.previewVisible=!1,this.previewCurrentId=null,this.previewType=null,this.previewCode=null},updateEditSlideStatus:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var s,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.updateEditSlideLoading){t.next=26;break}if(t.prev=1,e.updateEditSlideLoading=!0,s=parseInt(e.content.type),n=null,s!==e.$classcipe.typeMap.task){t.next=11;break}return t.next=8,Object(a["c"])({taskId:e.content.id,needRefresh:!0});case 8:n=t.sent,t.next=15;break;case 11:if(s!==e.$classcipe.typeMap.pd){t.next=15;break}return t.next=14,Object(a["c"])({taskId:e.content.id,needRefresh:!0});case 14:n=t.sent;case 15:n&&0===n.code&&(e.content.presentationId=n.result.presentationId,e.content.pageObjects=n.result.pageObjects),e.content.slideEditing=!1,t.next=21;break;case 19:t.prev=19,t.t0=t["catch"](1);case 21:return t.prev=21,e.updateEditSlideLoading=!1,i=e.contentReget(),0===i.code&&(e.content.canPublish=i.result.canPublish),t.finish(21);case 26:case"end":return t.stop()}}),t,null,[[1,19,21,26]])})))()},contentReget:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=parseInt(e.content.type),n=null,s!==e.$classcipe.typeMap.task){t.next=8;break}return t.next=5,Object(r["TaskQueryById"])({id:e.content.id});case 5:n=t.sent,t.next=12;break;case 8:if(s!==e.$classcipe.typeMap.pd){t.next=12;break}return t.next=11,Object(c["c"])({id:e.content.id});case 11:n=t.sent;case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}}),t)})))()},simpleIsEmpty:function(e){return null===e||""===e||void 0===e||(!(!e.hasOwnProperty("length")||0!==e.length)||"{}"===JSON.stringify(e))},calculateCanPublish:function(){var e=this,t=!0;this.emptyRequiredFields=[],this.formSteps.forEach((function(e){e.showRequiredTips=!1,e.showSatisfiedTips=!1})),this.requiredFields.forEach((function(s){var n;s===i["R"].Slides||s===i["u"].Slides?e.content.presentationId&&null!==(n=e.content.pageObjects)&&void 0!==n&&n.length||(e.emptyRequiredFields.push(s),e.formSteps.forEach((function(e){e.commonFields.indexOf(s)>-1&&(e.showRequiredTips=!0,e.showSatisfiedTips=!1,t=!1)}))):s===i["R"].Link||s===i["v"].Link||"learnOuts"===s||"questions"===s||"overview"===s||"goals"===s||e.simpleIsEmpty(e.content[s])&&(e.$logger.info("".concat(s," is empty"),e.content[s]),e.emptyRequiredFields.push(s),e.formSteps.forEach((function(e){e.commonFields.indexOf(s)>-1&&(e.showRequiredTips=!0,e.showSatisfiedTips=!1,t=!1)})))})),this.content.canPublish,this.content.canPublish=t}}}},fae4:function(e,t,s){},fe45:function(e,t,s){"use strict";s("d340")}}]);