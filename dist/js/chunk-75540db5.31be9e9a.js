(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75540db5"],{"0a72":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-full-form-wrapper",attrs:{id:"formRoot"}},[n("fixed-form-header",{scopedSlots:t._u([{key:"header",fn:function(){return[n("form-header",{attrs:{title:"School Account","show-share":!1,"show-collaborate":!1,"is-preview-mode":!0},on:{back:t.goBack},scopedSlots:t._u([{key:"back",fn:function(){return[n("img",{staticClass:"single-logo-img",attrs:{src:a("be50"),alt:"classcipe"},on:{click:function(e){return e.stopPropagation(),t.$router.push("/")}}})]},proxy:!0},{key:"left",fn:function(){return[n("a-space",{attrs:{size:5,align:"center"},on:{click:function(t){t.stopPropagation()}}},[n("label",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$router.push("/account/info")}}},[t._v("Account Info")]),n("label",{attrs:{for:""}},[t._v(">")]),n("label",{staticStyle:{"font-weight":"normal"}},[t._v("Academic")])])]},proxy:!0},{key:"right",fn:function(){return[n("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("Add Academic Year")])]},proxy:!0}])})]},proxy:!0}])}),n("div",{staticClass:"form-content"},[t.datas&&t.datas.length>0?n("div",{staticClass:"list-view"},t._l(t.datas,(function(e){return n("div",{key:"academic_"+e.id,staticClass:"list-view-item"},[n("div",{staticClass:"view-item-title"},[n("label",{attrs:{for:""}},[t._v(t._s(e.name))]),n("a-button",{attrs:{type:"link"},on:{click:function(a){return t.handleEdit(e)}}},[t._v("Edit")]),t.yearHasClass(e)?n("a-tooltip",{attrs:{title:"There are terms set under this Academic Year, you can only delete this year after you clear all the relevant terms."}},[n("a-button",{attrs:{type:"link",loading:t.delLoading}},[t._v("Delete")])],1):n("a-button",{attrs:{type:"link",loading:t.delLoading},on:{click:function(a){return t.handleDelete(e)}}},[t._v("Delete")])],1),n("div",{staticClass:"view-item-detail"},[t._l(e.terms,(function(a,i){return n("div",{key:"term_"+i,staticClass:"item-detail-content-wrap"},[n("div",{staticClass:"item-detail-content"},[n("div",{staticClass:"detail-content-title"},[n("label",[t._v(t._s(a.name))]),n("a-space",{attrs:{size:"middle"}},[n("a-button",{staticStyle:{color:"#15c39a"},attrs:{type:"link"},on:{click:function(n){return t.handleEditTerm(e,a)}}},[t._v("Edit")]),n("a-button",{staticStyle:{color:"#15c39a"},attrs:{type:"link"},on:{click:function(e){return t.handleEditBlock(a)}}},[t._v("Block scheduling")])],1)],1),n("div",{staticClass:"detail-content-time"},[t._v(t._s(t.formatDate(a))+" "+t._s(t.isCurrent(a)?"(Current)":""))]),n("div",{staticClass:"detail-content-close"},[t.termHasClass(a)?n("a-tooltip",{attrs:{title:"This grade has linked with class, you can only delete this grade after you archive all the relevant classes."}},[n("a-icon",{attrs:{type:"close-circle"}})],1):n("a-icon",{attrs:{type:"close-circle"},on:{click:function(e){return t.handleDeleteTerm(a)}}})],1)])])})),n("div",{staticClass:"item-detail-content-wrap"},[n("div",{staticStyle:{width:"120px",display:"flex","align-items":"center","justify-content":"center",height:"100%"}},[n("custom-text-button",{attrs:{label:"Add Term"},on:{click:function(a){return t.handleAddTerm(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[n("a-icon",{attrs:{type:"plus-circle"}})]},proxy:!0}],null,!0)})],1)])],2)])})),0):n("div",{staticClass:"no-subject"},[n("img",{attrs:{src:a("11f0")}}),n("p",[t._v("None academic because you dont set the academic")])])]),n("academic-year-add",{ref:"modalForm",on:{close:t.handleClose}}),n("academic-term-add",{ref:"termForm",on:{close:t.handleClose}}),n("academic-block-add",{ref:"blockForm",on:{close:t.handleClose}})],1)},i=[],o=a("5530"),s=(a("d3b7"),a("c740"),a("159b"),a("b0c0"),a("4de4"),a("7db0"),a("99af"),a("f93e")),r=a("6e84"),l=a("21fb"),c=a("e806"),d=a("ad59"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,confirmLoading:t.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===t.mode?"Add":"Save"},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form-model",{ref:"form",attrs:{model:t.model,rules:t.validatorRules}},[a("a-form-model-item",{attrs:{label:"Title"}},[a("a-input",{attrs:{placeholder:"Title"},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1),a("a-form-model-item",{attrs:{label:"Start on"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{"disabled-date":function(e){return t.disabledStartDate(e,t.model)},allowClear:!1,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"Pick a date"},on:{change:function(e){return t.changeStartTime(e,t.model)}},model:{value:t.model.startTime,callback:function(e){t.$set(t.model,"startTime",e)},expression:"model.startTime"}})],1),a("a-form-model-item",{attrs:{label:"End on"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{"disabled-date":function(e){return t.disabledEndDate(e,t.model)},allowClear:!1,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"Pick a date"},model:{value:t.model.endTime,callback:function(e){t.$set(t.model,"endTime",e)},expression:"model.endTime"}})],1)],1)],1)],1)},m=[],f=a("ad00"),h=a("2f62"),b=a("c1df"),p=a.n(b),g=a("cd3f"),v=a.n(g),k={name:"AcademicYearAddV2",mixins:[r["a"],l["a"]],components:{JModal:f["a"]},data:function(){return{title:"Add academic year",mode:"add",width:800,visible:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"modalAdd"}),model:{id:"",name:"",schoolId:this.currentSchool?this.currentSchool.id:"",startTime:"",endTime:""}}},created:function(){this.modelDefault=JSON.parse(JSON.stringify(this.model))},computed:Object(o["a"])(Object(o["a"])({},Object(h["e"])({userMode:function(t){return t.app.userMode},currentSchool:function(t){return t.user.currentSchool}})),{},{validatorRules:function(){var t={name:[{required:!0,message:"Please input term name!"}]};return t}}),methods:{handleSchoolChange:function(t){this.model.schoolId=t.id},disabledStartDate:function(t,e){var a=e.endTime;return!(!t||!a)&&p()(t).startOf("day").valueOf()>p()(a).endOf("day").valueOf()},disabledEndDate:function(t,e){var a=e.startTime;return!(!t||!a)&&p()(a).startOf("day").valueOf()>=p()(t).endOf("day").valueOf()},changeStartTime:function(t,e){t&&!e.endTime&&(e.endTime=p()(t).add(1,"years").subtract(1,"days").format("YYYY-MM-DD"))},add:function(){this.mode="add",this.edit(this.modelDefault)},edit:function(t){this.model=v()(Object.assign({},t,{schoolId:this.currentSchool.id})),this.mode="update",this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.$refs.form.clearValidate()},handleOk:function(){var t=this,e=this;this.$refs.form.validate((function(a){if(!a)return!1;e.confirmLoading=!0;var n=c["b"];t.model.id&&(n=c["f"]);var i=Object(o["a"])({},t.model);i.startTime=p()(i.startTime).startOf("day").utc().format("YYYY-MM-DD HH:mm:ss"),i.endTime=p()(i.endTime).endOf("day").utc().format("YYYY-MM-DD HH:mm:ss"),n(i).then((function(t){t.success?(e.$message.success(t.message),e.close()):e.$message.warning(t.message)})).finally((function(t){e.confirmLoading=!1}))}))},handleCancel:function(){this.visible=!1,this.confirmLoading=!1}}},y=k,Y=(a("7a99"),a("9f1a"),a("0c7c")),D=Object(Y["a"])(y,u,m,!1,null,"ad7412f2",null),O=D.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,confirmLoading:t.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===t.mode?"Add":"Save"},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form-model",{ref:"form",attrs:{model:t.model,rules:t.validatorRules}},[a("a-form-model-item",{attrs:{label:"Title"}},[a("a-input",{attrs:{placeholder:"Title"},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1),a("a-form-model-item",{attrs:{label:"Start on"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{"disabled-date":function(e){return t.disabledStartDate(e,t.model)},allowClear:!1,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",defaultPickerValue:t.model.minDate,placeholder:"Pick a date"},on:{change:function(e){return t.changeStartTime(e,t.model)}},model:{value:t.model.startTime,callback:function(e){t.$set(t.model,"startTime",e)},expression:"model.startTime"}})],1),a("a-form-model-item",{attrs:{label:"End on"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{"disabled-date":function(e){return t.disabledEndDate(e,t.model)},allowClear:!1,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",defaultPickerValue:t.model.minDate,placeholder:"Pick a date"},model:{value:t.model.endTime,callback:function(e){t.$set(t.model,"endTime",e)},expression:"model.endTime"}})],1)],1)],1)],1)},T=[],C={name:"AcademicTermAdd",mixins:[r["a"],l["a"]],components:{JModal:f["a"]},data:function(){return{title:"Add Academic Term",moment:p.a,mode:"add",width:800,visible:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"modalAdd"}),model:{id:"",parentId:"",name:"",schoolId:this.currentSchool?this.currentSchool.id:"",startTime:"",endTime:"",minDate:"",maxDate:""}}},created:function(){this.modelDefault=JSON.parse(JSON.stringify(this.model))},computed:Object(o["a"])(Object(o["a"])({},Object(h["e"])({userMode:function(t){return t.app.userMode},currentSchool:function(t){return t.user.currentSchool}})),{},{validatorRules:function(){var t={name:[{required:!0,message:"Please input term name!"}]};return t}}),methods:{handleSchoolChange:function(t){this.model.schoolId=t.id},disabledStartDate:function(t,e){var a=e.endTime,n=this.model.minDate,i=this.model.maxDate;return a||(a=i),!(!t||!a)&&!(p()(t).startOf("day").valueOf()>=p()(n).valueOf()&&p()(t).startOf("day").valueOf()<=p()(a).endOf("day").valueOf())},disabledEndDate:function(t,e){var a=e.startTime,n=this.model.minDate,i=this.model.maxDate;return a||(a=n),!(!t||!a)&&!(p()(t).endOf("day").valueOf()>=p()(a).startOf("day").valueOf()&&p()(t).endOf("day").valueOf()<=p()(i).valueOf())},changeStartTime:function(t,e){t&&!e.endTime&&(e.endTime=p()(t).add(3,"months").subtract(1,"days").format("YYYY-MM-DD"))},add:function(t){this.mode="add",this.edit(Object(o["a"])(Object(o["a"])({},this.modelDefault),t))},edit:function(t){this.model=v()(Object.assign({},t,{schoolId:this.currentSchool.id})),this.mode="update",this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.$refs.form.clearValidate()},handleOk:function(){var t=this,e=this;this.$refs.form.validate((function(a){if(!a)return!1;e.confirmLoading=!0;var n=c["a"];t.model.id&&(n=c["e"]);var i=Object(o["a"])({},t.model);i.startTime=p()(i.startTime).startOf("day").utc().format("YYYY-MM-DD HH:mm:ss"),i.endTime=p()(i.endTime).endOf("day").utc().format("YYYY-MM-DD HH:mm:ss"),n(i).then((function(t){t.success?(e.$message.success(t.message),e.close()):e.$message.warning(t.message)})).finally((function(t){e.confirmLoading=!1}))}))},handleCancel:function(){this.visible=!1,this.confirmLoading=!1}}},M=C,j=(a("65f2"),a("d3e9"),Object(Y["a"])(M,S,T,!1,null,"5dbbf1a4",null)),$=j.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,confirmLoading:t.confirmLoading,switchFullscreen:"",cancelText:"Cancel",okText:"add"===t.mode?"Add":"Save"},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form-model",t._b({ref:"form",attrs:{layout:"horizontal",model:t.model,rules:t.validatorRules}},"a-form-model",t.formItemLayout,!1),[a("a-form-model-item",{attrs:{label:"Block duration",prop:"blockDuration"}},[a("a-input-number",{staticStyle:{width:"150px"},attrs:{placeholder:"Block duration",suffix:"Min"},on:{change:t.changeDuration},model:{value:t.model.blockDuration,callback:function(e){t.$set(t.model,"blockDuration",e)},expression:"model.blockDuration"}}),t._v(" Min ")],1),t._l(t.model.blockSettings,(function(e,n){return a("a-form-model-item",{key:"modelItem"+n,staticClass:"mb0",attrs:{label:"Block "+(n+1)}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"blockSettings."+n+".start",rules:t.validatorRules.start}},[a("a-time-picker",{staticStyle:{width:"100%"},attrs:{allowClear:!1,placeholder:"Pick a time",defaultValue:t.moment("00:00:00","HH:mm:ss"),disabledHours:function(){return t.disabledHours(n)},disabledMinutes:function(e){return t.disabledMinutes(e,n)},format:"HH:mm"},on:{change:function(a,n){return t.changestart(a,n,e)}},model:{value:e.start,callback:function(a){t.$set(e,"start",a)},expression:"item.start"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:""}},[t._v(" - "+t._s(e.end)+" ")])],1),a("a-col",{attrs:{span:6}},[t.model.blockSettings.length>1?a("label",{staticClass:"dynamic-delete-button",attrs:{for:"",disabled:1===t.model.blockSettings.length},on:{click:function(a){return t.removeItem(e)}}},[t._v("Delete")]):t._e()])],1)],1)})),a("a-form-model-item",{attrs:{wrapperCol:{offset:6}}},[a("a-button",{staticClass:"add-button",attrs:{type:"link",disabled:t.disabledAdd,for:""},on:{click:t.addItem}},[t._v("+ Add")])],1)],2)],1)],1)},w=[],_=(a("fb6a"),a("caad"),a("2532"),a("a630"),a("3ca3"),a("a434"),a("d81d"),{name:"AcademicTermAdd",mixins:[r["a"],l["a"]],components:{JModal:f["a"]},data:function(){return{title:"Block Scheduling",moment:p.a,mode:"add",width:600,visible:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"modalAdd"}),formItemLayout:{labelCol:{span:6},wrapperCol:{span:18}},model:{termId:"",name:"",schoolId:this.currentSchool?this.currentSchool.id:"",blockDuration:0,blockSettings:[{id:"",name:"",start:"",end:""}]}}},created:function(){this.modelDefault=JSON.parse(JSON.stringify(this.model))},computed:Object(o["a"])(Object(o["a"])({},Object(h["e"])({userMode:function(t){return t.app.userMode},currentSchool:function(t){return t.user.currentSchool}})),{},{validatorRules:function(){var t={blockDuration:[{required:!0,message:"Please input block duration!"}],start:[{required:!0,message:"Please input block start!"},{validator:this.validateDate,trigger:"change"}]};return t},disabledAdd:function(){var t=this.model.blockSettings.slice(-1);return!(!(t&&t.length>0)||t[0].start)}}),methods:{handleSchoolChange:function(t){this.model.schoolId=t.id},changestart:function(t,e,a){this.model.blockDuration?a.end=p()("2000-01-01 "+e).add(parseInt(this.model.blockDuration||0),"minutes").format("HH:mm"):a.end=e},add:function(t){this.mode="add",this.edit(Object(o["a"])(Object(o["a"])({},this.modelDefault),t))},edit:function(t){this.model=v()(Object.assign({},t,{schoolId:this.currentSchool.id})),this.model.blockSettings?this.model.blockSettings.forEach((function(t){t.start=p()("2000-01-01 "+t.start),t.end=p()("2000-01-01 "+t.end).format("HH:mm")})):this.model.blockSettings=[],this.mode="update",this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.$refs.form.clearValidate()},changeDuration:function(t){var e=this;this.model.blockSettings.forEach((function(e){if(e.start){var a=p()(e.start).format("YYYY-MM-DD HH:mm:ss"),n=p()(a).add(parseInt(t||0),"minutes").format("HH:mm");e.end=n}})),this.model.blockSettings=this.model.blockSettings.filter((function(t,a){if(0===a||!t.start)return!0;var n=e.disabledHours(a),i=e.disabledMinutes(t.start.hours(),a);return n.includes(t.start.hours())||i.includes(t.start.minutes()),!1}))},validateDate:function(t,e,a){if(e){var n=e.format("HH:mm"),i=this.model.blockSettings.findIndex((function(t){return t.start.format("HH:mm")===n})),o=this.disabledHours(i),s=this.disabledMinutes(e.hours(),i);return o.includes(e.hours())||s.includes(e.minutes())?a(new Error("block time collapses")):a()}return a()},disabledHours:function(t){var e=0,a=23;return t>0&&(e=p()(this.model.blockSettings[t-1].end,"HH:mm").hours()),t<this.model.blockSettings.length-1&&(a=p()(this.model.blockSettings[t+1].start,"HH:mm").subtract(parseInt(this.model.blockDuration||0),"minutes").hours()),Array.from({length:e},(function(t,e){return e})).concat(Array.from({length:23-a},(function(t,e){return 23-e})))},disabledMinutes:function(t,e){var a=0,n=59,i=0,o=0;if(e>0&&(i=p()(this.model.blockSettings[e-1].end,"HH:mm").hours(),a=p()(this.model.blockSettings[e-1].end,"HH:mm").minutes()),e<this.model.blockSettings.length-1){var s=p()(this.model.blockSettings[e+1].start,"HH:mm").subtract(parseInt(this.model.blockDuration||0),"minutes");o=s.hours(),n=s.minutes()}var r=[];return i===t&&(r=Array.from({length:a},(function(t,e){return e})).concat(r)),o===t&&(r=r.concat(Array.from({length:59-n},(function(t,e){return 59-e})))),r},addItem:function(){var t,e="",a=parseInt(this.model.blockDuration||0);if(this.model.blockSettings.length>0){var n=this.model.blockSettings[this.model.blockSettings.length-1];t=p()(n.start).add(1,"hours"),e=t?p()(t).add(a,"minutes").format("HH:mm"):""}t=void 0,e="",this.model.blockSettings.push({name:"",start:t,end:e})},removeItem:function(t){var e=this.model.blockSettings.indexOf(t);-1!==e&&this.model.blockSettings.splice(e,1)},handleOk:function(){var t=this,e=this;this.$refs.form.validate((function(a){if(!a)return!1;var n=v()(t.model);n.blockSettings=n.blockSettings.map((function(t,e){return t.start=p()(t.start).format("HH:mm"),t.end=p()(p()("2000-01-01 "+t.end)).format("HH:mm"),t.name=t.name?t.name:"block_"+(new Date).getTime()+"_"+e,t})),e.confirmLoading=!0,Object(c["g"])(n).then((function(t){t.success?(e.$message.success(t.message),e.close()):e.$message.warning(t.message)})).finally((function(t){e.confirmLoading=!1}))}))},handleCancel:function(){this.visible=!1,this.confirmLoading=!1}}}),A=_,F=(a("6235"),a("9038"),Object(Y["a"])(A,H,w,!1,null,"ed32dbda",null)),x=F.exports,I=a("b5ff8"),L=a("b5a9"),E=a("20ae"),B=a("4fcf"),N=B.debounce,P={name:"AcademicListV2",mixins:[r["a"],l["a"]],components:{AcademicYearAdd:O,AcademicTermAdd:$,AcademicBlockAdd:x,FixedFormHeader:I["a"],FormHeader:L["a"],CustomTextButton:E["a"]},data:function(){return{USER_MODE:s["Y"],loading:!1,queryParams:{keywords:""},datas:[],debounceInit:null,delLoading:!1,subjectClass:[]}},created:function(){this.initData(),this.debounceInit=N(this.initData,300)},computed:Object(o["a"])({},Object(h["e"])({userMode:function(t){return t.app.userMode},currentSchool:function(t){return t.user.currentSchool}})),methods:{goBack:function(){this.$router.go(-1)},handleSchoolChange:function(t){this.userMode===s["Y"].SCHOOL&&this.debounceInit()},handleModeChange:function(t){this.debounceInit()},initData:function(){this.initClass(),this.loadData()},initClass:function(){var t=this;Object(d["g"])({queryType:1,pageNo:1,pageSize:1e4,schoolId:this.currentSchool.id}).then((function(e){e.success&&e.result&&(t.subjectClass=e.result.records)}))},loadData:function(){var t=this;this.loading=!0,Object(c["h"])(Object(o["a"])(Object(o["a"])({},this.queryParams),{},{schoolId:this.currentSchool.id})).then((function(e){e.success&&0===e.code?t.datas=e.result:t.datas=[]})).finally((function(){t.loading=!1}))},handleAdd:function(){this.$refs.modalForm.title="Add Academic Year",this.$refs.modalForm.mode="add",this.$refs.modalForm.add({})},handleAddTerm:function(t){this.$refs.termForm.title="Add Academic Term",this.$refs.termForm.mode="add";var e="";if(t.terms&&t.terms.length>0){var a=t.terms[t.terms.length-1];e=p.a.utc(a.endTime).local().format("YYYY-MM-DD HH:mm:ss")}else e=p.a.utc(t.startTime).startOf("day").local().format("YYYY-MM-DD HH:mm:ss");this.$refs.termForm.add({parentId:t.id,minDate:e,maxDate:p.a.utc(t.endTime).endOf("day").local().format("YYYY-MM-DD HH:mm:ss")})},handleEdit:function(t){this.$refs.modalForm.title="Edit Academic Year",this.$refs.modalForm.edit(Object(o["a"])(Object(o["a"])({},t),{},{startTime:p.a.utc(t.startTime).local().format("YYYY-MM-DD HH:mm:ss"),endTime:p.a.utc(t.endTime).local().format("YYYY-MM-DD HH:mm:ss")})),this.$refs.modalForm.disableSubmit=!1},handleEditTerm:function(t,e){this.$refs.termForm.title="Edit Academic Term",this.$refs.termForm.mode="edit";var a="";if(t.terms&&t.terms.length>0){var n=t.terms.findIndex((function(t){return t.id===e.id})),i=t.terms[n-1];a=i?p.a.utc(i.endTime).local().format("YYYY-MM-DD HH:mm:ss"):p.a.utc(t.startTime).startOf("day").local().format("YYYY-MM-DD HH:mm:ss")}else a=p.a.utc(t.startTime).startOf("day").local().format("YYYY-MM-DD HH:mm:ss");this.$refs.termForm.edit(Object(o["a"])(Object(o["a"])({parentId:t.id,minDate:a,maxDate:p.a.utc(t.endTime).endOf("day").local().format("YYYY-MM-DD HH:mm:ss")},e),{},{startTime:p.a.utc(e.startTime).local().format("YYYY-MM-DD HH:mm:ss"),endTime:p.a.utc(e.endTime).local().format("YYYY-MM-DD HH:mm:ss")}))},handleEditBlock:function(t){this.$refs.blockForm.title="Block scheduling",this.$refs.blockForm.mode="add",this.$refs.blockForm.edit(Object(o["a"])({},t.block))},handleDelete:function(t,e){var a=this;if(this.$logger.info("handleDelete ",t),t.terms&&t.terms.length>0){var n=!1;if(t.terms.forEach((function(t){a.termHasClass(t)&&(n=!0)})),n)return void this.$message.error("You can not delete this term because you have schedule subject class for this term.")}this.$confirm({title:"Confirm delete academic",content:"Are you confirm delete academic "+t.name+" ?",centered:!0,onOk:function(){a.delLoading=!0,Object(c["d"])({id:t.id}).then((function(e){e.success&&(a.datas=a.datas.filter((function(e){return e.id!==t.id})),a.$message.success("Delete successfully"))})).finally((function(){a.delLoading=!1}))}})},handleDeleteTerm:function(t,e){var a=this;this.termHasClass(t)?this.$message.error("You can not delete this term because you have schedule subject class for this term."):(this.$logger.info("handleDeleteTerm ",t),this.$confirm({title:"Confirm delete term",content:"Are you confirm delete term "+t.name+" ?",centered:!0,onOk:function(){a.delLoading=!0,Object(c["c"])({termId:t.id}).then((function(t){t.success&&(a.loadData(),a.$message.success("Delete successfully"))})).finally((function(){a.delLoading=!1}))}}))},yearHasClass:function(t){var e=this,a=!1;return t.terms&&t.terms.length>0&&t.terms.forEach((function(t){e.termHasClass(t)&&(a=!0)})),a},termHasClass:function(t){var e=this.subjectClass.find((function(e){return e.term===t.id}));return e},triggerSearch:function(){this.debounceInit()},formatDate:function(t){return"".concat(p.a.utc(t.startTime).local().format("MMMM YYYY")," - ").concat(p.a.utc(t.endTime).local().format("MMMM YYYY"))},isCurrent:function(t){return p()().isBefore(p()(t.endTime))&&p()().isAfter(p()(t.startTime))},handleClose:function(){this.loadData()}}},J=P,R=(a("8eeb6"),Object(Y["a"])(J,n,i,!1,null,"3c507b59",null));e["default"]=R.exports},"0aff":function(t,e,a){"use strict";a("9469")},"11f0":function(t,e,a){t.exports=a.p+"img/no-subject.e2d87663.png"},"21fb":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("b0c0");var n={data:function(){return{unwatch:null,routeName:this.$route.name}},created:function(){var t=this;this.unwatch=this.$store.watch((function(t){return t.user.currentSchool}),(function(e){return e&&t.$route.name===t.routeName&&t.handleSchoolChange(e)}))},computed:{},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{handleSchoolChange:function(t){}}}},"346d":function(t,e,a){},3722:function(t,e,a){},6235:function(t,e,a){"use strict";a("b557")},"65f2":function(t,e,a){"use strict";a("a424")},"6e84":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("b0c0");var n={data:function(){return{unwatch:null,routeName:this.$route.name}},computed:{redirectUrl:function(){return"student"===this.$store.state.user.currentRole?"/student/main/my-task":"/account/info"}},created:function(){var t=this;this.unwatch=this.$store.watch((function(t){return t.app.userMode}),(function(e){e&&t.$route.name===t.routeName&&(t.handleModeChange(e),t.routeInMode())})),this.routeInMode()},beforeDestroy:function(){this.unwatch&&this.unwatch()},methods:{routeInMode:function(){this.$route.meta.mode&&this.$route.meta.mode!==this.$store.state.app.userMode&&this.$router.push({path:this.redirectUrl})},handleModeChange:function(t){}}}},"7a99":function(t,e,a){"use strict";a("df6f")},"8eeb6":function(t,e,a){"use strict";a("e11d")},9038:function(t,e,a){"use strict";a("3722")},9469:function(t,e,a){},"9f1a":function(t,e,a){"use strict";a("c6cdb")},a424:function(t,e,a){},ad00:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",t._g(t._b({ref:"modal",class:t.getClass(t.modalClass),style:t.getStyle(t.modalStyle),attrs:{visible:t.visible,destroyOnClose:"",maskClosable:!1},on:{ok:t.handleOk,cancel:t.handleCancel},scopedSlots:t._u([t._l(t.slotsKeys,(function(e){return{key:e,fn:function(){return[t._t(e)]},proxy:!0}}))],null,!0)},"a-modal",t._attrs,!1),t.$listeners),[t._t("default"),t.isNoTitle?a("template",{slot:"title"},[a("a-row",{staticClass:"j-modal-title-row",attrs:{type:"flex"}},[t.switchFullscreen?a("a-col",{staticClass:"right",on:{click:t.toggleFullscreen}},[a("a-button",{staticClass:"ant-modal-close ant-modal-close-x",attrs:{ghost:"",type:"link",icon:t.fullscreenButtonIcon}})],1):t._e()],1)],1):a("template",{slot:"title"},[a("a-row",{staticClass:"j-modal-title-row",attrs:{type:"flex"}},[a("a-col",{staticClass:"left"},[t._t("title",(function(){return[t._v(t._s(t.title))]}))],2),t.switchFullscreen?a("a-col",{staticClass:"right",on:{click:t.toggleFullscreen}},[a("a-button",{staticClass:"ant-modal-close ant-modal-close-x",attrs:{ghost:"",type:"link",icon:t.fullscreenButtonIcon}})],1):t._e()],1)],1),t._l(t.scopedSlotsKeys,(function(e){return a("template",{slot:e},[t._t(e)],2)}))],2)},i=[],o=a("5530"),s=(a("caad"),a("2532"),a("4de4"),a("b64b"),a("99af"),a("53ca"));a("a15b"),a("ac1f"),a("5319"),a("159b"),a("1276"),a("498a");function r(){for(var t=[],e=0;e<arguments.length;e++){var a=arguments[e];if(a){var n=Object(s["a"])(a);if("string"===n||"number"===n)t.push(a);else if(Array.isArray(a)&&a.length){var i=r.apply(null,a);i&&t.push(i)}else if("object"===n)for(var o in a)a.hasOwnProperty(o)&&a[o]&&t.push(o)}}return t.join(" ")}var l=/-(\w)/g;function c(t){return t.replace(l,(function(t,e){return e?e.toUpperCase():""}))}function d(t){var e={};return Object.keys(t).forEach((function(a){return e[c(a)]=t[a]})),e}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,a={},n=/;(?![^(]*\))/g,i=/:(.+)/;return t.split(n).forEach((function(t){if(t){var n=t.split(i);if(n.length>1){var o=e?c(n[0].trim()):n[0].trim();a[o]=n[1].trim()}}})),a}function m(t){var e={};t.data?e=t.data:t.$vnode&&t.$vnode.data&&(e=t.$vnode.data);var a=e.class||{},n=e.staticClass,i={};return n&&n.split(" ").forEach((function(t){i[t.trim()]=!0})),"string"===typeof a?a.split(" ").forEach((function(t){i[t.trim()]=!0})):Array.isArray(a)?r(a).split(" ").forEach((function(t){i[t.trim()]=!0})):i=Object(o["a"])(Object(o["a"])({},i),a),i}function f(t,e){m(t);var a={};t.data?a=t.data:t.$vnode&&t.$vnode.data&&(a=t.$vnode.data);var n=a.style||{},i=a.staticStyle;return i=i?d(a.staticStyle):{},"string"===typeof n?n=u(n,e):e&&n&&(n=d(n)),Object(o["a"])(Object(o["a"])({},i),n)}var h=a("ca00"),b={name:"JModal",props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},switchFullscreen:{type:Boolean,default:!1},okClose:{type:Boolean,default:!0}},data:function(){return{usedSlots:["title"],innerFullscreen:this.fullscreen}},computed:{_attrs:function(){var t=Object(o["a"])({},this.$attrs);return this.innerFullscreen&&(t["width"]="100%"),t},modalClass:function(){return{"j-modal-box":!0,fullscreen:this.innerFullscreen,"no-title":this.isNoTitle,"no-footer":this.isNoFooter}},modalStyle:function(){var t={};return this.innerFullscreen&&(t["top"]="0"),t},isNoTitle:function(){return!this.title&&!this.allSlotsKeys.includes("title")},isNoFooter:function(){return null===this._attrs["footer"]},slotsKeys:function(){var t=this;return Object.keys(this.$slots).filter((function(e){return!t.usedSlots.includes(e)}))},scopedSlotsKeys:function(){var t=this;return Object.keys(this.$scopedSlots).filter((function(e){return!t.usedSlots.includes(e)}))},allSlotsKeys:function(){return Object.keys(this.$slots).concat(Object.keys(this.$scopedSlots))},fullscreenButtonIcon:function(){return this.innerFullscreen?"fullscreen-exit":"fullscreen"}},watch:{visible:function(){this.visible&&(this.innerFullscreen=this.fullscreen)},innerFullscreen:function(t){this.$emit("update:fullscreen",t)}},methods:{getClass:function(t){return Object(o["a"])(Object(o["a"])({},m(this)),t)},getStyle:function(t){return Object(o["a"])(Object(o["a"])({},f(this)),t)},close:function(){this.$emit("update:visible",!1)},handleOk:function(){this.okClose&&this.close()},handleCancel:function(){this.close()},toggleFullscreen:function(){this.innerFullscreen=!this.innerFullscreen,Object(h["triggerWindowResizeEvent"])()}}},p=b,g=(a("0aff"),a("0c7c")),v=Object(g["a"])(p,n,i,!1,null,null,null);e["a"]=v.exports},b557:function(t,e,a){},c6cdb:function(t,e,a){},d3e9:function(t,e,a){"use strict";a("346d")},df6f:function(t,e,a){},e11d:function(t,e,a){},e806:function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"e",(function(){return d})),a.d(e,"f",(function(){return u})),a.d(e,"g",(function(){return m})),a.d(e,"h",(function(){return f}));var n=a("b775"),i="academic/academicTermInfo",o={addTerm:"/classcipe/".concat(i,"/addTerm"),addYear:"/classcipe/".concat(i,"/addYear"),deleteTerm:"/classcipe/".concat(i,"/deleteTerm"),deleteYear:"/classcipe/".concat(i,"/deleteYear"),editTerm:"/classcipe/".concat(i,"/editTerm"),editYear:"/classcipe/".concat(i,"/editYear"),saveBlockSetting:"/classcipe/".concat(i,"/saveBlockSetting"),termList:"/classcipe/".concat(i,"/termList")};function s(t){return Object(n["d"])({url:o.addTerm,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(t){return Object(n["d"])({url:o.deleteTerm,method:"delete",params:t})}function l(t){return Object(n["d"])({url:o.deleteYear,method:"delete",params:t})}function c(t){return Object(n["d"])({url:o.addYear,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(t){return Object(n["d"])({url:o.editTerm,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(t){return Object(n["d"])({url:o.editYear,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(t){return Object(n["d"])({url:o.saveBlockSetting,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(t){return Object(n["d"])({url:o.termList,method:"get",params:t})}}}]);