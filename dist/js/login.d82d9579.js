(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{1439:function(e,t,a){"use strict";a("889d")},"307f":function(e,t,a){"use strict";a("8e05")},"35a5":function(e,t,a){},"50f6c":function(e,t,a){},"7a05":function(e,t,a){"use strict";a("50f6c")},"889d":function(e,t,a){},"8e05":function(e,t,a){},a3d0:function(e,t,a){"use strict";a("35a5")},ac2a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-login"},[a("a-tabs",{attrs:{type:"card",defaultActiveKey:e.defaultActiveKey},model:{value:e.defaultActiveKey,callback:function(t){e.defaultActiveKey=t},expression:"defaultActiveKey"}},[e.onlyTab&&"teacher"!==e.onlyTab?e._e():a("a-tab-pane",{key:"teacher",attrs:{tab:"Teacher"}},[a("div",{staticClass:"login"},[a("div",[a("div",{staticClass:"desc"},[e._v("Sign In")]),a("div",{staticClass:"desc2"},[e._v(" Don't have an account? | "),a("span",[a("router-link",{attrs:{to:{path:e.registerPath}}},[e._v("Sign Up")])],1)])]),a("div",{staticClass:"third-login-wrapper"},[a("third-login-button",{attrs:{icon:"googleIcon",label:e.$t("user.login.loginWithGoogle"),type:"google"},nativeOn:{click:function(t){return e.thirdSignIn("google","teacher")}}})],1)])]),e.onlyTab&&"student"!==e.onlyTab?e._e():a("a-tab-pane",{key:"student",attrs:{tab:"Student"}},[a("div",{staticClass:"login"},[a("div",[a("div",{staticClass:"desc"},[e._v("Sign In")]),a("div",{staticClass:"desc2"},[e._v(" Don't have an account? | "),a("span",[a("router-link",{attrs:{to:{path:e.registerPath}}},[e._v("Sign Up")])],1)])]),a("a-form",{staticClass:"login-form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",{staticClass:"form-email"},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,message:"Please Enter You Acccount"}],validateTrigger:["change","blur"]}],expression:"[\n                'email',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: 'Please Enter You Acccount',\n                    },\n                  ],\n                  validateTrigger: ['change', 'blur'],\n                },\n              ]"}],attrs:{size:"large",type:"text",placeholder:e.$t("user.login.username.placeholder")}})],1),a("a-form-item",{staticClass:"form-password"},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:e.$t("user.password.required")}],validateTrigger:["change","blur"]}],expression:"[\n                'password',\n                {\n                  rules: [{ required: true, message: $t('user.password.required') }],\n                  validateTrigger: ['change', 'blur'],\n                },\n              ]"}],attrs:{size:"large",placeholder:e.$t("user.login.password.placeholder")}}),a("div",{staticClass:"error-message"},[e._v(" "+e._s(e.studentLoginErrorMessage)+" ")])],1),a("a-form-item",{staticClass:"form-btn"},[a("a-checkbox",{attrs:{defaultChecked:""},on:{change:e.handleChange}},[e._v("Remember me")]),a("a",{staticClass:"forget-password",on:{click:e.handleForget}},[e._v("Forget password")]),a("a-button",{attrs:{type:"primary",block:"",loading:e.loading,size:"large","html-type":"submit"}},[e._v(" Log In ")])],1)],1),a("div",{staticClass:"or"},[a("div",{staticClass:"line"}),a("div",{staticClass:"text"},[e._v("OR")]),a("div",{staticClass:"line"})]),a("div",{staticClass:"third-login-wrapper"},[a("third-login-button",{attrs:{icon:"googleIcon",label:e.$t("user.login.loginWithGoogle")},nativeOn:{click:function(t){return e.thirdSignIn("google","student")}}})],1)],1)])],1),a("forget-password-modal",{ref:"modal"})],1)},s=[],n=a("5530"),i=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("ac1f"),a("841c"),function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("a-modal",{attrs:{centered:"",maskClosable:!1},on:{cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("div",{style:{textAlign:"center"},attrs:{slot:"title"},slot:"title"},[t._v("两步验证")]),r("template",{slot:"footer"},[r("div",{style:{textAlign:"center"}},[r("a-button",{key:"back",on:{click:t.handleCancel}},[t._v("返回")]),r("a-button",{key:"submit",attrs:{type:"primary",loading:t.stepLoading},on:{click:t.handleStepOk}},[t._v(" 继续 ")])],1)]),r("a-spin",{attrs:{spinning:t.stepLoading}},[r("a-form",{attrs:{layout:"vertical","auto-form-create":function(t){e.form=t}}},[r("div",{staticClass:"step-form-wrapper"},[t.stepLoading?r("p",{staticStyle:{"text-align":"center"}},[t._v("正在验证.."),r("br"),t._v("请稍后")]):r("p",{staticStyle:{"text-align":"center"}},[t._v("请在手机中打开 Google Authenticator 或两步验证 APP"),r("br"),t._v("输入 6 位动态码")]),r("a-form-item",{style:{textAlign:"center"},attrs:{hasFeedback:"",fieldDecoratorId:"stepCode",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入 6 位动态码!",pattern:/^\d{6}$/,len:6}]}}},[r("a-input",{style:{textAlign:"center"},attrs:{placeholder:"000000"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleStepOk.apply(null,arguments)}}})],1),r("p",{staticStyle:{"text-align":"center"}},[r("a",{on:{click:t.onForgeStepCode}},[t._v("遗失手机?")])])],1)])],1)],2)}),o=[],l={props:{visible:{type:Boolean,default:!1}},data:function(){return{stepLoading:!1,form:null}},methods:{handleStepOk:function(){var e=this,t=this;this.stepLoading=!0,this.form.validateFields((function(a,r){a?(e.stepLoading=!1,e.$emit("error",{err:a})):setTimeout((function(){t.stepLoading=!1,t.$emit("success",{values:r})}),2e3)}))},handleCancel:function(){this.visible=!1,this.$emit("cancel")},onForgeStepCode:function(){}}},c=l,u=(a("edd4"),a("0c7c")),d=Object(u["a"])(c,i,o,!1,null,"4a462ef6",null),g=d.exports,f=a("d07e"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticClass:"user-forget",attrs:{footer:null,visible:e.visible},on:{cancel:e.handleCancel}},[a("div",{staticClass:"user-forget-wrapper"},[a("div",{staticClass:"title"},[e._v("Reset Your Password")]),a("div",{staticClass:"desc"},[e._v(" Enter the "),a("span",[e._v("Email Address")]),e._v(" you used to create an account,and we will send you instructions on how to change your password. ")]),a("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",{staticClass:"form-email"},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,type:"email",message:"Please enter a valid email address"}],validateTrigger:["change","blur"]}],expression:"[\n            'username',\n            {\n              rules: [\n                {\n                  required: true,\n                  type: 'email',\n                  message: 'Please enter a valid email address',\n                },\n              ],\n              validateTrigger: ['change', 'blur'],\n            },\n          ]"}],attrs:{size:"large",type:"text",placeholder:e.$t("user.login.username.placeholder")}})],1),a("a-form-item",{staticClass:"form-submit"},[a("a-button",{attrs:{type:"primary",block:"",loading:e.loading,size:"large","html-type":"submit"}},[e._v("Submit")])],1)],1),a("div",{staticClass:"desc"},[e._v(" Forget your email? Contact us at "),a("a",{attrs:{href:"mailto:support@Classcipe.com"}},[e._v("support@Classcipe.com")])])],1)])},m=[],v=a("1da1"),p=(a("96cf"),a("7ded")),b={components:{},data:function(){return{form:this.$form.createForm(this),visible:!1,loading:!1}},created:function(){},methods:{show:function(){this.visible=!0},handleCancel:function(){this.visible=!1},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(a,r){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=7;break}return t.loading=!0,s=Object(n["a"])({},r),e.next=5,Object(p["f"])(s);case 5:i=e.sent,i.success?(t.loading=!1,t.$message.success("send email success"),t.visible=!1):(t.loading=!1,t.$message.error(i.message));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}}},y=b,k=(a("307f"),a("a3d0"),Object(u["a"])(y,h,m,!1,null,"35285f34",null)),w=k.exports,C=a("2f62"),_=a("dbdc"),$=a("9fb0"),S=a("8ded"),x=a.n(S),O=a("f93e"),A=a("ca00"),q={components:{TwoStepCaptcha:g,ThirdLoginButton:f["a"],ForgetPasswordModal:w},data:function(){return{loading:!1,defaultActiveKey:"teacher",form:this.$form.createForm(this),registerPath:"/user/register",callbackUrl:"",studentLoginErrorMessage:null}},created:function(){var e=new URLSearchParams(window.location.search),t=e.get("role"),a=e.get("callbackUrl"),r=e.get("redirect");r?this.registerPath="/user/register?redirect=".concat(r):a&&(this.registerPath="/user/register?redirect=".concat(a)),t&&(this.defaultActiveKey=t),a?this.callbackUrl=a:r&&(this.callbackUrl=r),this.$route.query&&this.$route.query.only&&(this.defaultActiveKey=this.$route.query.only)},computed:{onlyTab:function(){return this.$route.query&&this.$route.query.only?this.$route.query.only:""}},methods:Object(n["a"])(Object(n["a"])({},Object(C["b"])(["Login","Logout"])),{},{thirdSignIn:function(e,t){var a;switch("teacher"===t&&x.a.set($["n"],!1),e){case"google":case"zoom":this.$logger.info("thirdSignIn google",e),a=Object(_["b"])(e),a+="?role=".concat(t),a+="&channelId=".concat(Object(A["getCookie"])($["v"])),a+="&callbackUrl=",a+=_["c"],this.callbackUrl&&window.sessionStorage.setItem(O["C"],Object(A["getUrlWithNoParams"])(this.callbackUrl)),this.$logger.info("full auth url ",a),window.location.href=a;break;default:break}},handleSubmit:function(e){var t=this;this.studentLoginErrorMessage=null,e.preventDefault();var a=this.form.validateFields,r=this.Login;a({force:!0},(function(e,a){if(!e){t.loading=!0;var s={username:a.email,password:a.password,role:t.defaultActiveKey};"student"===s.role&&(Object(A["isEmail"])(a.email)||(delete s.username,s.workNo=a.email)),r(s).then((function(e){return t.loginSuccess(e)})).catch((function(e){return t.requestFailed(e)})).finally((function(){t.loading=!1}))}}))},loginSuccess:function(e){var t=this;this.$message.success(e.message),this.$store.dispatch("GetInfo").then((function(a){var r=t.callbackUrl;r?window.location.href=r+(r.indexOf("?")>-1?"&":"?")+"token="+e.result.token:t.$store.getters.currentRole?t.$router.push(t.$store.getters.defaultRouter):location.href="/v2/login?call="+location.pathname})).catch((function(e){t.$message.error("GetInfo Failed,"+e)}))},requestFailed:function(e){this.studentLoginErrorMessage=e.message},handleForget:function(){this.$refs.modal.show()},handleChange:function(e){var t=e.target.checked;x.a.set($["n"],!t)}})},L=q,F=(a("1439"),a("7a05"),Object(u["a"])(L,r,s,!1,null,"99583326",null));t["default"]=F.exports},af7a:function(e,t,a){},edd4:function(e,t,a){"use strict";a("af7a")}}]);