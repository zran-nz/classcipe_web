(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59736301"],{"0bb4":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return c}));var o=a("b775"),n={listCementByUser:"/classcipe/sys/annountCement/listByUser",editCementSend:"/classcipe/sys/sysAnnouncementSend/editByAnntIdAndUserId",NoticeQueryById:"/classcipe/sys/annountCement/queryById",listByMessage:"/classcipe/sys/annountCement/listByMessage"};function i(t){return Object(o["d"])({url:n.editCementSend,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(t){return Object(o["d"])({url:n.listCementByUser,method:"get",params:t})}function s(t){return Object(o["d"])({url:n.NoticeQueryById,method:"get",params:t})}function c(t){return Object(o["d"])({url:n.listByMessage,method:"get",params:t})}},"332d":function(t,e,a){var o=a("b2b7");t.exports={__esModule:!0,default:o.svgComponent({tag:"svg",attrsMap:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"68",height:"68",viewBox:"0 0 68 68"},children:[{tag:"defs",children:[{tag:"filter",attrsMap:{id:"a",x:"0",y:"0",width:"68",height:"68",filterUnits:"userSpaceOnUse"},children:[{tag:"feOffset",attrsMap:{dy:"3",input:"SourceAlpha"}},{tag:"feGaussianBlur",attrsMap:{stdDeviation:"3",result:"b"}},{tag:"feFlood",attrsMap:{"flood-color":"#7a7a7a","flood-opacity":"0.161"}},{tag:"feComposite",attrsMap:{operator:"in",in2:"b"}},{tag:"feComposite",attrsMap:{in:"SourceGraphic"}}]}]},{tag:"g",attrsMap:{transform:"translate(24271 8092)"},children:[{tag:"g",attrsMap:{class:"c",transform:"matrix(1, 0, 0, 1, -24271, -8092)"},children:[{tag:"path",attrsMap:{class:"a",style:"fill:rgba(255,255,255,0.9);",d:"M25,0A25,25,0,1,1,0,25,25,25,0,0,1,25,0Z",transform:"translate(9 6)"}}]},{tag:"path",attrsMap:{class:"b",style:"fill:#15c39a;",d:"M10.33,21.506h-.154V17.929c0-1.338-.74-1.9-1.653-1.135L.041,23.871a1.736,1.736,0,0,0,0,2.763l8.42,7c.913.757,1.716-.012,1.716-1.139V28.721h1.275a8.8,8.8,0,0,1,8.212,4.831c.338.577.693.451.693,0-.073-5.67-4.7-12.044-10.025-12.044v0Z",transform:"translate(-24246.355 -8086.451)"}}]}]})}},"523d":function(t,e,a){"use strict";a.d(e,"o",(function(){return i})),a.d(e,"n",(function(){return r})),a.d(e,"u",(function(){return s})),a.d(e,"q",(function(){return c})),a.d(e,"p",(function(){return l})),a.d(e,"a",(function(){return d})),a.d(e,"r",(function(){return u})),a.d(e,"t",(function(){return p})),a.d(e,"j",(function(){return h})),a.d(e,"e",(function(){return b})),a.d(e,"b",(function(){return f})),a.d(e,"l",(function(){return m})),a.d(e,"m",(function(){return C})),a.d(e,"g",(function(){return y})),a.d(e,"h",(function(){return g})),a.d(e,"f",(function(){return v})),a.d(e,"c",(function(){return j})),a.d(e,"s",(function(){return O})),a.d(e,"k",(function(){return T})),a.d(e,"i",(function(){return M})),a.d(e,"d",(function(){return S}));var o=a("b775"),n={InviteCollaborate:"/classcipe/api/collaborate/invite",GetCollaborateUsers:"/classcipe/api/collaborate/getCollaborateUsers",GetShared:"/classcipe/api/collaborate/getShared",GetSharedNotReceived:"/classcipe/api/collaborate/getSharedNotReceived",GetFindSharedNotReceived:"/classcipe/api/collaborate/getFindSharedNotReceived",DeleteCollaborate:"/classcipe/api/collaborate/delete",DeleteByMeCollaborate:"/classcipe/api/collaborate/deleteByMe",ReceiveCollaborate:"/classcipe/api/collaborate/receive",GetCollaborateComment:"/classcipe/api/editMessage/queryNewMessage",DeleteCollaborateCommentById:"/classcipe/api/editMessage/delete",MarkedCollaborateComment:"/classcipe/api/editMessage/marked",AddCollaborateComment:"/classcipe/api/editMessage/addMessage",GetCollaborateModifiedHistory:"/classcipe/api/editMessage/queryHistory",QueryContentCollaborates:"/classcipe/api/collaborate/v2/queryContentCollaborates",CollaboratesSearchUser:"/classcipe/api/collaborate/v2/searchUser",CollaboratesInvite:"/classcipe/api/collaborate/v2/invite",CollaboratesAgree:"/classcipe/api/collaborate/v2/agree",CollaboratesUpdate:"/classcipe/api/collaborate/v2/updateCollaborate",CollaboratesRemove:"/classcipe/api/collaborate/v2/remove",CollaboratesDeleteByOthers:"/classcipe/api/collaborate/v2/deleteByOthers",CollaboratesUpdateLink:"/classcipe/api/collaborate/v2/updateLink",CollaboratesQueryShared:"/classcipe/api/collaborate/v2/queryShared",CollaboratesQuerySharedOwner:"/classcipe/api/collaborate/v2/querySharedOwner",QueryByLinkCode:"/classcipe/api/collaborate/v2/queryByLinkCode",CollaboratesApply:"/classcipe/api/collaborate/v2/apply",CollaboratesSendInviteEmail:"/classcipe/api/collaborate/v2/sendInviteEmail"};function i(t){return Object(o["d"])({url:n.DeleteCollaborate,method:"post",data:t})}function r(t){return Object(o["d"])({url:n.DeleteByMeCollaborate,method:"post",data:t})}function s(t){return Object(o["d"])({url:n.ReceiveCollaborate,method:"post",data:t})}function c(t){return Object(o["d"])({url:n.GetCollaborateComment,method:"post",data:t})}function l(t){return Object(o["d"])({url:n.DeleteCollaborateCommentById+"?id="+t.id,method:"post",data:t})}function d(t){return Object(o["d"])({url:n.AddCollaborateComment,method:"post",data:t})}function u(t){return Object(o["d"])({url:n.GetCollaborateModifiedHistory,method:"post",data:t})}function p(t){return Object(o["d"])({url:n.QueryContentCollaborates,method:"get",params:t})}function h(t){return Object(o["d"])({url:n.CollaboratesSearchUser,method:"get",params:t})}function b(t){return Object(o["d"])({url:n.CollaboratesInvite,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(t){return Object(o["d"])({url:n.CollaboratesAgree,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(t){return Object(o["d"])({url:n.CollaboratesUpdate,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function C(t){return Object(o["d"])({url:n.CollaboratesUpdateLink,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function y(t){return Object(o["d"])({url:n.CollaboratesQueryShared,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function g(t){return Object(o["d"])({url:n.CollaboratesQuerySharedOwner,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function v(t){return Object(o["d"])({url:n.QueryByLinkCode,method:"get",params:t})}function j(t){return Object(o["d"])({url:n.CollaboratesApply,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function O(t){return Object(o["d"])({url:n.MarkedCollaborateComment+"?id="+t.id,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function T(t){return Object(o["d"])({url:n.CollaboratesSendInviteEmail,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function M(t){return Object(o["d"])({url:n.CollaboratesRemove,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function S(t){return Object(o["d"])({url:n.CollaboratesDeleteByOthers,method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},"5a7d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("a-card",{attrs:{bordered:!1}},[o("div",{staticClass:"notification-detail"},[o("div",{staticClass:"top"},[o("div",{staticClass:"left-wrapper"},[o("div",{staticClass:"back",on:{click:t.handleGoBack}},[o("div",{staticClass:"back-icon"},[o("img",{attrs:{src:a("bb5f")}})]),o("div",{staticClass:"back-text"},[t._v(" Back ")])])])]),o("div",{staticClass:"main-body"},[o("div",{staticClass:"header-line"},[o("div",{staticClass:"user-info"},[o("div",{staticClass:"avatar-wrapper"},[o("img",{attrs:{src:t.notificationData.avatar}})]),o("div",{staticClass:"post-info"},[o("div",{staticClass:"post-by"},[t._v(" "+t._s(t.notificationData.postBy)+" ")]),o("div",{staticClass:"post-time"},[t._v(" "+t._s(t._f("dayjs")(t.notificationData.sendTime))+" ")])])]),o("div",{staticClass:"action-btn-wrapper"},[o("div",{staticClass:"action-btn-list"},[t.notificationData.busType===t.notificationTypeMap.collaborateInvite?void 0:t._e()],2)])]),o("div",{staticClass:"content-body",staticStyle:{cursor:"pointer"},on:{click:t.showAnnouncement}},[o("div",{staticClass:"content-title"},[t._v(" "+t._s(t.notificationData.titile)+" ")]),o("div",{staticClass:"content-detail"},[t._v(" "+t._s(t.notificationData.msgContent)+" ")])])])])])},n=[],i=(a("d3b7"),a("a434"),a("ac1f"),a("5319"),a("332d")),r=a.n(i),s=a("d20c"),c=a("0bb4"),l=a("9fb0"),d=a("523d"),u=a("823b"),p=a("3f76"),h=a("fd38"),b={name:"NotificationDetail",components:{backIconSvg:r.a},mixins:[h["a"]],props:{id:{type:String,required:!0}},watch:{$route:function(t,e){this.loadMessageData()}},data:function(){return{notificationData:{},notificationTypeMap:s["a"],acceptLoading:!1,refuseLoading:!1}},created:function(){this.$logger.info("loadMessageData "+this.id),this.loadMessageData()},methods:{loadMessageData:function(){var t=this;Object(c["d"])({id:this.id}).then((function(e){t.$logger.info("loadMessageData ",e),t.loading=!1,e.success?t.notificationData=e.result:t.$message.error(e.message)})).finally((function(){"0"===t.notificationData.readFlag&&Object(c["a"])({anntId:t.id}).then((function(){t.$store.commit(l["o"],!0)})),t.$route.query&&"1"===t.$route.query.direct&&t.viewNotification(t.notificationData)}))},handleAcceptCollaborate:function(){var t=this;this.$logger.info("handleAcceptCollaborate",this.notificationData),this.acceptLoading=!0,Object(d["b"])({id:this.notificationData.busId,agreeFlag:p["a"].agree}).then((function(e){u["info"]("handleApply",e),t.$message.success("collaborate successfully")})).then((function(){t.acceptLoading=!1,t.loadMessageData()}))},handleRefuseCollaborate:function(){var t=this;this.$logger.info("handleRefuseCollaborate",this.notificationData),this.refuseLoading=!0,Object(d["o"])({id:this.notificationData.busId}).then((function(t){u["info"]("handleRefuseCollaborate",t)})).then((function(){t.loadMessageData()})).finally((function(){t.refuseLoading=!1}))},handleLinkItem:function(t,e){u["info"]("handleLinkItem",t),e.preventDefault(),e.stopPropagation();var a=this.mySelectedList.indexOf(t.id);-1!==a?this.mySelectedList.splice(a,1):this.mySelectedList.push(t.id)},handleGoBack:function(){return this.$router.replace({path:"/notification"}),this.$router.go(-1),!1},showAnnouncement:function(){"url"===this.notificationData.openType&&(this.openPath=this.notificationData.openPage,this.formData={id:this.notificationData.busId},this.$router.push({path:this.notificationData.openPage}))}}},f=b,m=(a("ed705"),a("0c7c")),C=Object(m["a"])(f,o,n,!1,null,"653feb98",null);e["default"]=C.exports},7147:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var o={CreatedByMe:0,SharedByMe:1,SharedByOthers:2,Archived:3}},bb5f:function(t,e,a){t.exports=a.p+"img/back.2a730e4a.png"},c752:function(t,e,a){},d20c:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var o={collaborateInvite:"collaborateInvite",collaborateApply:"collaborateApply",collaborateRejected:"collaborateRejected",collaborateRemoved:"collaborateRemoved",changeCollaborate:"changeCollaborate",collaborateAccepted:"collaborateAccepted",mentioned:"mentioned",replied:"replied",favorites:"star",collaborateFavoriote:"collaborateFavoriote"}},ed705:function(t,e,a){"use strict";a("c752")},fd38:function(t,e,a){"use strict";a.d(e,"a",(function(){return u}));var o=a("5530"),n=(a("ac1f"),a("1276"),a("d3b7"),a("25f0"),a("3f76")),i=a("d20c"),r=a("0bb4"),s=a("9fb0"),c=a("2f62"),l=a("7147"),d=a("f93e"),u={components:{},data:function(){return{}},created:function(){var t=this;this.$store.watch((function(t){return t.websocket.receiveMsg}),(function(e){e&&(t.loadNewNotifications(),t.$store.commit(s["o"],!1))}))},methods:Object(o["a"])(Object(o["a"])({},Object(c["b"])(["refreshCollaborateAction"])),{},{gotoContent:function(t){if("-1"!==t.busId){var e=t.busId.split("#");parseInt(e[0])===n["e"].task?this.$router.push({path:"/teacher/task-redirect/"+e[1]}):parseInt(e[0])===n["e"].pd?this.$router.push({path:"/teacher/pd-content-redirect/"+e[1]}):parseInt(e[0])===n["e"]["unit-plan"]&&this.$router.push({path:"/teacher/unit-plan-redirect/"+e[1]})}else this.$router.push({path:"/teacher/main/created-by-me"})},setShareType:function(t){t.busType===i["a"].collaborateRejected||t.busType===i["a"].collaborateApply?sessionStorage.setItem(d["J"],l["a"].SharedByMe.toString()):t.busType!==i["a"].collaborateAccepted&&t.busType!==i["a"].collaborateInvite||sessionStorage.setItem(d["J"],l["a"].SharedByOthers.toString())},viewNotification:function(t){var e=this,a=this.$createElement;if(this.$logger.info("viewNotification",t),"0"===t.readFlag&&(Object(r["a"])({anntId:t.id}).then((function(){e.$store.commit(s["o"],!0)})),t.readFlag="1"),this.setShareType(t),t.busType===i["a"].collaborateApply)this.gotoContent(t),setTimeout((function(){e.refreshCollaborateAction(t.busId)}),4e3);else if(t.busType===i["a"].collaborateAccepted||t.busType===i["a"].collaborateInvite)this.gotoContent(t);else if(t.busType===i["a"].collaborateRejected)this.$router.push({path:"/teacher/main/created-by-me"});else{if(t.busType===i["a"].collaborateRemoved)return void this.$warning({title:"Alert",content:a("div",[a("h2",["You have been removed from the collaborating list, you can no longer edit it."])])});if("url"===t.openType){if(t.busType===i["a"].collaborateFavoriote)return void(t.readFlag="1");this.$router.push({path:t.openPage})}else this.$route.query&&"1"===this.$route.query.direct||this.$router.push({path:"/notification-detail/"+t.id})}this.handleHoverChange&&this.handleHoverChange(!1)},loadNewNotifications:function(){var t=this;Object(r["c"])().then((function(e){if(e.success){var a=e.result.anntMsgTotal;t.$store.commit("SET_UNREAD_COUNT",a||0)}})).catch((function(e){t.$logger.error("系统消息通知异常",e),t.stopTimer=!0,t.$logger.error("清理timer")}))}})}}}]);